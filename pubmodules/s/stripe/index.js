var _0x4fa6=['sort','--\x20>\x20subscription\x20get\x20by\x20id\x20freq.params.subscriptionid\x20','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20>\x20profile','create','»»»\x20»»»\x20updatesubscription\x20userid','billing_reason','--\x20>\x20get\x20customer\x20from\x20db\x20-\x20subscription\x20>\x20customer\x20id\x20','save','invoice_settings','expiration_date_month','object','customer.subscription.deleted\x20subscriptionPayment\x20project\x20id:\x20','Types','subscription.deleted','sessionid','exports','del','YYYY-MM-DDTHH:mm:ss.SSS','constructEvent','send','current_period_end','update','userid','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20>\x20profile\x20>\x20agents\x20typeof','unix','post','name','detachPaymentFunct\x20>\x20paymentMethodid\x20','checkout','paymentMethods','profile','***\x20***\x20checkout.session.completed\x20-\x20getSubscritionById\x20subscr\x20object_type:\x20','/:subscriptionid','--\x20>\x20cancelsubscription\x20confirmation\x20','info','--\x20>\x20updatesubscription\x20\x20project\x20','--\x20>\x20cancelsubscription\x20\x20project\x20','stripe\x20apiSecretKey','stripe\x20client_reference_id','savedSubscriptionPayment\x20','»»»\x20»»»\x20cancelsubscription\x20userid','»»»\x20»»»\x20\x20paymentMethod','get\x20PaymentMethods\x20list\x20>\x20paymentMethods\x20','canceled_at','price','/customers/:customerid','format','stripe','subscription_create','body','subscriptionid','stripe\x20apiKey','--\x20>\x20get\x20customer\x20from\x20db\x20>\x20customer\x20from\x20stripe\x20API\x20','catch','sessions','detachPaymentFunc\x20result\x20','end','json','****\x20Stripe\x20error\x20constructEvent:\x20','--\x20>\x20subscription\x20get\x20by\x20id\x20from\x20stripe\x20','--\x20>\x20checkoutSession\x20params.sessionid\x20','--\x20>\x20cancelsubscription\x20Error\x20getting\x20project\x20','ObjectId','log','Error\x20saving\x20object.','stripe\x20checkout.session.completed','detach','***\x20***\x20invoice.payment_succeeded\x20-\x20subscription\x20ID:\x20','stripe\x20user_id:','../../../middleware/passport','--\x20>\x20checkoutSession\x20get\x20by\x20id\x20from\x20stripe\x20','***\x20***\x20subscription\x20ID\x20','Webhook\x20Error:\x20','stripe\x20project_id:\x20','total_count','mongoose','--\x20>\x20GET\x20SUBSCRIPTION\x20PAYMENTS\x20ERRORt\x20','Router','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20','***\x20***\x20invoice.payment_succeeded\x20-\x20end:\x20','/checkoutSession/:sessionid','/webhook','PAYMENT_STRIPE_API_SECRET_KEY','***\x20***\x20checkout.session.completed\x20-\x20getSubscritionById\x20***\x20start\x20***\x20:\x20','project_id','»»»\x20»»»\x20\x20update\x20customer\x20-\x20customerid\x20from\x20params\x20','headers','saveOnDB\x20seats_num','updateProjectProfile\x20Error\x20','customer.subscription.deleted','customer.subscription.deleted\x20event\x20','get\x20PaymentMethods\x20list\x20>\x20paymentMethods\x20>\x20paymentMethods.data\x20','findByIdAndUpdate','---\x20>\x20ERROR\x20','rawBody','quotes','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20subsptn_payment\x20>\x20project_id:\x20','***\x20***\x20»»»\x20»»»\x20customer.subscription.deleted\x20subscriptionPayment\x20','»»»\x20»»»\x20\x20update\x20customer\x20-\x20cc\x20from\x20body\x20','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20subsptn_payment:\x20','***\x20***\x20invoice.payment_succeeded\x20-\x20BILLING\x20REASON\x20','--\x20>\x20subscription\x20get\x20by\x20id\x20from\x20stripe\x20\x20err\x20','debug','saveFirstInvoicePaymentSucceeded\x20stripe_event','free','data','subscriptionId','stripe\x20endpointSecret','customerid','--\x20>\x20get\x20customer\x20from\x20db\x20>\x20customer\x20+\x20paymentMethods\x20','forEach','status','lines','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20>\x20profile\x20>\x20name','invoice.payment_succeeded','»»»»\x20stripe\x20apiKey:\x20','client_reference_id','params','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20subsptn_payment\x20typeof\x20subsptn_payment:\x20','get\x20PaymentMethods\x20list\x20req.params\x20>\x20customer_id\x20','default_payment_method','find','findOne','customer','message','type','raw','typeof\x20','***\x20***\x20invoice.payment_succeeded\x20-\x20start:\x20','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20-\x20err\x20','user_id','card','expiration_date_year','/payment_methods/:customerid','../../../middleware/valid-token','get','projectid','split','checkout.session.completed','../models/subscription-payment','subscriptions','error','/stripesubs/:subscriptionid','--\x20>\x20cancelsubscription\x20\x20err\x20','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20find\x20Project\x20','then','retrieve','--\x20>\x20updatesubscription\x20Error\x20getting\x20project\x20','»»»»\x20stripe\x20endpointSecret:\x20','customers','credit_card_cvc','payment','»»»\x20»»»\x20get\x20customer\x20from\x20db\x20-\x20projectid','--\x20>\x20checkoutSession\x20get\x20by\x20id\x20from\x20stripe\x20\x20err\x20','jwt','get\x20PaymentMethods\x20list\x20req.params','subscription','»»»\x20»»»\x20\x20paymentMethod\x20attached\x20\x20error\x20','customer.subscription.deleted\x20profile\x20to\x20update\x20','passport','express','put','basic','get\x20PaymentMethods\x20list\x20>\x20paymentMethods\x20>\x20default_payment_method_id\x20','savedSubscriptionPayment\x20>>\x20','../../../models/project','../../../config/winston','\x20typeof\x20','USECASE\x20\x20invoice.payment_succeeded\x20\x20billing_reason\x20subscription_create\x20','exec','agents','***\x20***\x20customer.subscription.deleted\x20','stripe-signature','application/json','stripe\x20plan_name:\x20','period','credit_card_num','stripe\x20sig:\x20','authenticate'];(function(_0x4d84ad,_0x4fa60c){var _0x539a10=function(_0x93afd0){while(--_0x93afd0){_0x4d84ad['push'](_0x4d84ad['shift']());}};_0x539a10(++_0x4fa60c);}(_0x4fa6,0x1a9));var _0x539a=function(_0x4d84ad,_0x4fa60c){_0x4d84ad=_0x4d84ad-0x0;var _0x539a10=_0x4fa6[_0x4d84ad];return _0x539a10;};var express=require(_0x539a('0x5d'));var router=express[_0x539a('0xa')]();var winston=require(_0x539a('0x63'));var Project=require(_0x539a('0x62'));var SubscriptionPayment=require(_0x539a('0x48'));var moment=require('moment');var mongoose=require(_0x539a('0x8'));var passport=require(_0x539a('0x5c'));require(_0x539a('0x2'))(passport);var validtoken=require(_0x539a('0x43'));const apiKey=process['env']['PAYMENT_STRIPE_APIKEY'];winston[_0x539a('0x23')](_0x539a('0xa3')+apiKey);const stripe=require(_0x539a('0x9f'))(apiKey);const endpointSecret=process['env']['PAYMENT_STRIPE_SECRET'];winston['debug'](_0x539a('0x28')+endpointSecret);const apiSecretKey=process['env'][_0x539a('0xf')];winston[_0x539a('0x23')]('stripe\x20apiSecretKey'+apiSecretKey);const bodyParser=require('body-parser');router[_0x539a('0x89')](_0x539a('0xe'),bodyParser[_0x539a('0x3b')]({'type':_0x539a('0x6a')}),function(_0x18373a,_0x49fd46){winston[_0x539a('0x23')](_0x539a('0x51')+endpointSecret);winston[_0x539a('0x23')](_0x539a('0x30')+apiKey);winston[_0x539a('0x23')](_0x539a('0x95')+apiSecretKey);const _0x3d8ee2=_0x18373a[_0x539a('0x13')][_0x539a('0x69')];winston[_0x539a('0x23')](_0x539a('0x6e'),_0x3d8ee2);let _0x49bed0;try{_0x49bed0=stripe['webhooks'][_0x539a('0x82')](_0x18373a[_0x539a('0x1b')],_0x3d8ee2,endpointSecret);}catch(_0x5f1a04){winston[_0x539a('0x4a')](_0x539a('0xaa'),_0x5f1a04[_0x539a('0x39')]);return _0x49fd46[_0x539a('0x2c')](0x190)[_0x539a('0x83')](_0x539a('0x5')+_0x5f1a04['message']);}if(_0x49bed0[_0x539a('0x3a')]===_0x539a('0x47')){winston[_0x539a('0x23')]('!!!!!!!!\x20HI\x20!!!!!!!!\x20checkout.session.completed');const _0x49b446=_0x49bed0['data']['object'];winston[_0x539a('0x92')](_0x539a('0xb1'),_0x49b446);var _0x3c37a9=_0x49b446[_0x539a('0x31')];winston[_0x539a('0x92')](_0x539a('0x96'),_0x3c37a9);var _0x3848b9=_0x3c37a9[_0x539a('0x46')]('_')[0x0];winston[_0x539a('0x92')](_0x539a('0x1')+_0x3848b9);var _0x5e392d=_0x3c37a9[_0x539a('0x46')]('_')[0x1];winston['info'](_0x539a('0x6')+_0x5e392d);var _0x4c2a82=_0x3c37a9[_0x539a('0x46')]('_')[0x2];winston['info'](_0x539a('0x6b')+_0x4c2a82);var _0x335990=_0x3c37a9[_0x539a('0x46')]('_')[0x3];winston[_0x539a('0x92')]('stripe\x20seats_num:\x20'+_0x335990+_0x539a('0x3c'),typeof _0x335990);var _0x43c851=Number(_0x335990);winston[_0x539a('0x92')]('stripe\x20seats_numAsString:\x20'+_0x43c851+_0x539a('0x64'),typeof _0x43c851);var _0x3c295d=_0x49bed0['data'][_0x539a('0x7a')]['subscription'];winston[_0x539a('0x92')]('***\x20***\x20!!!!!!!!!!!!!!!!!!!!!!\x20checkout.session.completed\x20-\x20subscription\x20ID:\x20',_0x3c295d);getSubscritionById(_0x3c295d)[_0x539a('0x4e')](function(_0x12c9a8){var _0x30e24f=_0x12c9a8[_0x539a('0x7a')];winston[_0x539a('0x92')](_0x539a('0x8f'),_0x30e24f);var _0x3f1d85=moment[_0x539a('0x88')](_0x12c9a8['current_period_start'])[_0x539a('0x9e')](_0x539a('0x81'));winston[_0x539a('0x92')](_0x539a('0x10'),_0x3f1d85);var _0x3d55f9=moment[_0x539a('0x88')](_0x12c9a8[_0x539a('0x84')])[_0x539a('0x9e')](_0x539a('0x81'));winston[_0x539a('0x92')]('***\x20***\x20checkout.session.completed\x20-\x20getSubscription\x20***\x20end\x20***\x20:\x20',_0x3d55f9);var _0x94bbf1={'profile':{'name':_0x4c2a82,'type':_0x539a('0x54'),'subscription_creation_date':_0x3f1d85,'subStart':_0x3f1d85,'subEnd':_0x3d55f9,'subscriptionId':_0x3c295d,'last_stripe_event':_0x49bed0[_0x539a('0x3a')],'agents':_0x43c851}};updateProjectProfile(_0x5e392d,_0x94bbf1,_0x539a('0x47'));saveOnDB(_0x3c295d,_0x5e392d,_0x12c9a8,_0x3848b9,_0x49bed0['type'],_0x4c2a82,_0x43c851);})[_0x539a('0xa5')](function(_0x233405){winston[_0x539a('0x4a')]('***\x20***\x20checkout.session.completed\x20-\x20getSubscritionById\x20err\x20',_0x233405);});}if(_0x49bed0[_0x539a('0x3a')]===_0x539a('0x2f')){winston[_0x539a('0x92')]('\x20!!!!!!!!\x20HI\x20!!!!!!!!\x20invoice.payment_succeeded');winston[_0x539a('0x92')](_0x539a('0x21'),_0x49bed0[_0x539a('0x26')][_0x539a('0x7a')][_0x539a('0x75')]);var _0xfdb430=_0x49bed0[_0x539a('0x26')][_0x539a('0x7a')]['lines'][_0x539a('0x7')];winston[_0x539a('0x92')]('***\x20***\x20invoice.payment_succeeded\x20-\x20linesNum:\x20',_0xfdb430);var _0x2bc471=_0xfdb430-0x1;winston[_0x539a('0x92')]('***\x20***\x20invoice.payment_succeeded\x20-\x20index:\x20',_0x2bc471);var _0x50c690=moment['unix'](_0x49bed0[_0x539a('0x26')][_0x539a('0x7a')][_0x539a('0x2d')][_0x539a('0x26')][_0x2bc471]['period']['start'])[_0x539a('0x9e')]('YYYY-MM-DDTHH:mm:ss.SSS');winston['info'](_0x539a('0x3d'),_0x50c690);var _0x342a4d=moment[_0x539a('0x88')](_0x49bed0[_0x539a('0x26')]['object'][_0x539a('0x2d')]['data'][_0x2bc471][_0x539a('0x6c')][_0x539a('0xa8')])[_0x539a('0x9e')]('YYYY-MM-DDTHH:mm:ss.SSS');winston[_0x539a('0x92')](_0x539a('0xc'),_0x342a4d);var _0x3c295d=_0x49bed0[_0x539a('0x26')][_0x539a('0x7a')][_0x539a('0x59')];winston[_0x539a('0x92')](_0x539a('0x0'),_0x3c295d);if(_0x3c295d==null){_0x3c295d=_0x49bed0[_0x539a('0x26')]['object']['lines'][_0x539a('0x26')][0x0][_0x539a('0x59')];winston[_0x539a('0x92')]('***\x20***\x20invoice.payment_succeeded\x20-\x20subscription\x20ID:\x20',_0x3c295d);}if(_0x49bed0[_0x539a('0x26')][_0x539a('0x7a')][_0x539a('0x75')]!==_0x539a('0xa0')){getSubByIdAndCheckoutSessionCompletedEvnt(_0x3c295d)['then'](function(_0x1090d3){winston[_0x539a('0x92')](_0x539a('0x20'),_0x1090d3);winston[_0x539a('0x92')](_0x539a('0x33'),typeof _0x1090d3);if(_0x1090d3){var _0x3a944d=_0x1090d3[_0x539a('0x11')];winston[_0x539a('0x92')](_0x539a('0x1d'),_0x3a944d);Project['findOne']({'_id':_0x3a944d},function(_0x3f7fdb,_0x584669){if(_0x3f7fdb){winston[_0x539a('0x92')](_0x539a('0x4d'),_0x3f7fdb);return _0x3f7fdb;}if(_0x584669){winston[_0x539a('0x92')](_0x539a('0xb'),_0x584669);winston[_0x539a('0x92')](_0x539a('0x72'),_0x584669[_0x539a('0x8e')]);var _0x48e0a3=_0x584669['profile'][_0x539a('0x67')];winston[_0x539a('0x92')]('***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20>\x20profile\x20>\x20agents',_0x48e0a3);var _0x4b649b=_0x584669['profile'][_0x539a('0x8a')];winston[_0x539a('0x92')](_0x539a('0x87'),typeof _0x48e0a3);var _0x1ca34c=_0x1090d3[_0x539a('0x3f')];winston[_0x539a('0x92')](_0x539a('0x2e'),_0x4b649b);var _0x50694b=_0x584669[_0x539a('0x8e')][_0x539a('0x1c')];var _0x65b49c={'profile':{'name':_0x4b649b,'type':_0x539a('0x54'),'subStart':_0x50c690,'subEnd':_0x342a4d,'subscriptionId':_0x3c295d,'last_stripe_event':_0x49bed0[_0x539a('0x3a')],'agents':_0x48e0a3,'quotes':_0x50694b}};updateProjectProfile(_0x3a944d,_0x65b49c,'invoice.payment_succeeded');saveOnDB(_0x3c295d,_0x3a944d,_0x49bed0,_0x1ca34c,_0x49bed0['type'],_0x4b649b,_0x48e0a3);}});}})[_0x539a('0xa5')](function(_0x477825){winston[_0x539a('0x4a')](_0x539a('0x3e'),_0x477825);});}else if(_0x49bed0[_0x539a('0x26')][_0x539a('0x7a')][_0x539a('0x75')]==='subscription_create'){console['log'](_0x539a('0x65'));saveFirstInvoicePaymentSucceeded(_0x3c295d,_0x49bed0,_0x49bed0[_0x539a('0x3a')]);}}if(_0x49bed0['type']===_0x539a('0x16')){winston[_0x539a('0x92')]('\x20!!!!!!!!\x20HI\x20!!!!!!!!!!!\x20customer.subscription.deleted');winston[_0x539a('0x92')](_0x539a('0x17'),_0x49bed0);var _0x3c295d=_0x49bed0[_0x539a('0x26')][_0x539a('0x7a')]['id'];winston[_0x539a('0x92')](_0x539a('0x4'),_0x3c295d);var _0x8e23c0=moment[_0x539a('0x88')](_0x49bed0[_0x539a('0x26')][_0x539a('0x7a')]['canceled_at'])[_0x539a('0x9e')](_0x539a('0x81'));winston[_0x539a('0x92')]('***\x20***\x20subscriptionEnd\x20',_0x8e23c0);getSubByIdAndCheckoutSessionCompletedEvnt(_0x3c295d)[_0x539a('0x4e')](function(_0x393a59){winston[_0x539a('0x92')](_0x539a('0x1e'),_0x393a59);if(_0x393a59){var _0x116b2f=_0x393a59[_0x539a('0x11')];winston[_0x539a('0x92')](_0x539a('0x7b'),_0x116b2f);var _0x4cd6f1=_0x393a59[_0x539a('0x3f')];winston[_0x539a('0x92')]('customer.subscription.deleted\x20subscriptionPayment\x20user\x20id:\x20',_0x4cd6f1);}var _0x4b7373={'profile':{'subscriptionId':_0x3c295d,'name':'Sandbox','type':_0x539a('0x25'),'agents':0x1,'last_stripe_event':_0x49bed0[_0x539a('0x3a')],'subEnd':_0x8e23c0}};winston[_0x539a('0x92')]('customer.subscription.deleted\x20profile\x20to\x20update\x20(event.data.object.canceled_at)\x20',_0x49bed0[_0x539a('0x26')][_0x539a('0x7a')][_0x539a('0x9b')]);winston[_0x539a('0x92')](_0x539a('0x5b'),_0x4b7373[_0x539a('0x8e')]);updateProjectProfile(_0x116b2f,_0x4b7373,_0x539a('0x7d'));saveOnDB(_0x3c295d,_0x116b2f,_0x49bed0[_0x539a('0x26')]['object'],_0x4cd6f1,_0x49bed0[_0x539a('0x3a')],_0x4c2a82,0x1);})[_0x539a('0xa5')](function(_0x2336a4){winston['error'](_0x539a('0x68'),_0x2336a4);});}_0x49fd46[_0x539a('0xa9')]({'received':!![]});});function getSubByIdAndCheckoutSessionCompletedEvnt(_0x52d593){return new Promise(function(_0x3c007d,_0x134aaa){SubscriptionPayment[_0x539a('0x37')]({'subscription_id':_0x52d593,'stripe_event':_0x539a('0x47')},function(_0x347f59,_0x5a2a33){if(_0x347f59)_0x134aaa(_0x347f59);var _0x195015=_0x5a2a33;_0x3c007d(_0x195015);});});};function getSubscritionById(_0x290013){return new Promise(function(_0x38ffef,_0x459285){const _0x52d35d=require(_0x539a('0x9f'))(apiSecretKey);_0x52d35d[_0x539a('0x49')][_0x539a('0x4f')](_0x290013,function(_0x2654a7,_0x143557){if(_0x2654a7)_0x459285(_0x2654a7);var _0x143557=_0x143557;_0x38ffef(_0x143557);});});};function updateProjectProfile(_0x5dffaf,_0x21e049,_0x4181a0){Project[_0x539a('0x19')](_0x5dffaf,_0x21e049,{'new':!![],'upsert':!![]},function(_0x4d7bb2,_0x3ee550){if(_0x4d7bb2){winston[_0x539a('0x4a')](_0x539a('0x15'),_0x4d7bb2);}else{winston[_0x539a('0x23')](_0x3ee550);}});}function saveOnDB(_0x4a11d6,_0x4761fc,_0x370d5e,_0x465dcc,_0x14af3c,_0x4a885c,_0x286b11){winston['info']('saveOnDB\x20plan_name',_0x4a885c);winston['info'](_0x539a('0x14'),_0x286b11);var _0xc69253=new SubscriptionPayment({'_id':new mongoose[(_0x539a('0x7c'))][(_0x539a('0xae'))](),'subscription_id':_0x4a11d6,'project_id':_0x4761fc,'user_id':_0x465dcc,'stripe_event':_0x14af3c,'plan_name':_0x4a885c,'agents':_0x286b11,'object':_0x370d5e});_0xc69253['save'](function(_0x1617c1,_0x46268b){if(_0x1617c1){winston[_0x539a('0x4a')](_0x539a('0x1a'),_0x1617c1);return res[_0x539a('0x2c')](0x1f4)[_0x539a('0x83')]({'success':![],'msg':'Error\x20saving\x20object.'});}winston[_0x539a('0x92')](_0x539a('0x97'),_0x46268b);});}function saveFirstInvoicePaymentSucceeded(_0x4a567c,_0x35cb40,_0x30e0e3){console['log']('saveFirstInvoicePaymentSucceeded\x20subscriptionid',_0x4a567c);console['log'](_0x539a('0x24'),_0x30e0e3);var _0x45b788=new SubscriptionPayment({'_id':new mongoose['Types']['ObjectId'](),'subscription_id':_0x4a567c,'stripe_event':_0x30e0e3,'object':_0x35cb40});_0x45b788[_0x539a('0x77')](function(_0x3aae86,_0x341bbe){if(_0x3aae86){winston['error'](_0x539a('0x1a'),_0x3aae86);return res[_0x539a('0x2c')](0x1f4)[_0x539a('0x83')]({'success':![],'msg':_0x539a('0xb0')});}console[_0x539a('0xaf')](_0x539a('0x61'),_0x341bbe);});}router[_0x539a('0x5e')]('/cancelsubscription',[passport[_0x539a('0x6f')](['basic','jwt'],{'session':![]}),validtoken],function(_0x3e8e4b,_0x1c729c){var _0x2cb0df=_0x3e8e4b[_0x539a('0xa1')][_0x539a('0x45')];var _0x3cea3b=_0x3e8e4b[_0x539a('0xa1')][_0x539a('0x86')];winston[_0x539a('0x92')]('»»»\x20»»»\x20cancelsubscription\x20projectid',_0x2cb0df);winston[_0x539a('0x92')](_0x539a('0x98'),_0x3cea3b);Project['findOne']({'_id':_0x2cb0df},function(_0x27c9ba,_0x5edf7c){if(_0x27c9ba){winston[_0x539a('0x4a')](_0x539a('0xad'),_0x27c9ba);return _0x27c9ba;}if(_0x5edf7c){winston[_0x539a('0x92')](_0x539a('0x94'),_0x5edf7c);var _0xe8c003=_0x5edf7c[_0x539a('0x8e')][_0x539a('0x27')];const _0x33b4d7=require('stripe')(apiSecretKey);_0x33b4d7['subscriptions'][_0x539a('0x80')](_0xe8c003,function(_0x5e3fb7,_0x447ebd){if(_0x5e3fb7){winston[_0x539a('0x4a')](_0x539a('0x4c'),_0x5e3fb7);return _0x1c729c[_0x539a('0x2c')](0x1f4)[_0x539a('0x83')]({'success':![],'msg':_0x5e3fb7});}winston['info'](_0x539a('0x91'),_0x447ebd);_0x1c729c['json'](_0x447ebd);});}});});router[_0x539a('0x5e')]('/updatesubscription',[passport[_0x539a('0x6f')]([_0x539a('0x5f'),_0x539a('0x57')],{'session':![]}),validtoken],function(_0x5bc60c,_0x1e7172){var _0x285528=_0x5bc60c['body'][_0x539a('0x45')];var _0xa9ca61=_0x5bc60c['body'][_0x539a('0x86')];var _0x4cd9d0=_0x5bc60c['body'][_0x539a('0x9c')];winston[_0x539a('0x92')]('»»»\x20»»»\x20updatesubscription\x20projectid',_0x285528);winston[_0x539a('0x92')](_0x539a('0x74'),_0xa9ca61);winston['info']('»»»\x20»»»\x20updatesubscription\x20price',_0x4cd9d0);const _0x355bde=require('stripe')(apiSecretKey);Project[_0x539a('0x37')]({'_id':_0x285528},function(_0x552ee3,_0x4aa533){if(_0x552ee3){winston[_0x539a('0x4a')](_0x539a('0x50'),_0x552ee3);return _0x552ee3;}if(_0x4aa533){winston['info'](_0x539a('0x93'),_0x4aa533);var _0x548b4=_0x4aa533[_0x539a('0x8e')][_0x539a('0x27')];_0x355bde[_0x539a('0x49')][_0x539a('0x85')](_0x548b4);}});});router[_0x539a('0x44')](_0x539a('0x90'),[passport[_0x539a('0x6f')]([_0x539a('0x5f'),'jwt'],{'session':![]}),validtoken],function(_0x5b55b0,_0x576e23){SubscriptionPayment[_0x539a('0x36')]({'subscription_id':_0x5b55b0[_0x539a('0x32')][_0x539a('0xa2')]})[_0x539a('0x70')]({'object.created':'asc'})[_0x539a('0x66')](function(_0x1035f4,_0x3df21e){if(_0x1035f4){winston['error'](_0x539a('0x9'),project);return _0x576e23[_0x539a('0x2c')](0x1f4)[_0x539a('0x83')]({'success':![],'msg':_0x1035f4});}_0x576e23['json'](_0x3df21e);});});router[_0x539a('0x44')](_0x539a('0x4b'),[passport[_0x539a('0x6f')]([_0x539a('0x5f'),_0x539a('0x57')],{'session':![]}),validtoken],function(_0x4d4a00,_0x33198b){winston[_0x539a('0x92')](_0x539a('0x71'),_0x4d4a00[_0x539a('0x32')][_0x539a('0xa2')]);var _0xdceb34=require(_0x539a('0x9f'))(apiSecretKey);_0xdceb34['subscriptions'][_0x539a('0x4f')](_0x4d4a00[_0x539a('0x32')][_0x539a('0xa2')],function(_0x56d98c,_0x33e46e){if(_0x56d98c){winston[_0x539a('0x4a')](_0x539a('0x22'),_0x56d98c);return _0x33198b['status'](0x1f4)[_0x539a('0x83')]({'success':![],'msg':_0x56d98c});}winston[_0x539a('0x92')](_0x539a('0xab'),_0x33e46e);_0x33198b['json'](_0x33e46e);});});router[_0x539a('0x44')](_0x539a('0xd'),[passport['authenticate']([_0x539a('0x5f'),'jwt'],{'session':![]}),validtoken],function(_0x5f170c,_0x499fb8){winston['info'](_0x539a('0xac'),_0x5f170c[_0x539a('0x32')][_0x539a('0x7e')]);var _0x146fa1=require(_0x539a('0x9f'))(apiSecretKey);_0x146fa1[_0x539a('0x8c')][_0x539a('0xa6')][_0x539a('0x4f')](_0x5f170c[_0x539a('0x32')]['sessionid'],function(_0x20e3d3,_0x1b45cb){if(_0x20e3d3){winston[_0x539a('0x92')](_0x539a('0x56'),_0x20e3d3);return _0x499fb8[_0x539a('0x2c')](0x1f4)[_0x539a('0x83')]({'success':![],'msg':_0x20e3d3});}winston[_0x539a('0x92')](_0x539a('0x3'),_0x1b45cb);_0x499fb8[_0x539a('0xa9')](_0x1b45cb);});});router[_0x539a('0x44')]('/customer/:projectid',[passport[_0x539a('0x6f')]([_0x539a('0x5f'),_0x539a('0x57')],{'session':![]}),validtoken],function(_0x1822f0,_0x65ae6f){winston['debug']('»»»\x20»»»\x20get\x20customer\x20from\x20db\x20',_0x1822f0[_0x539a('0x32')]);var _0x5a40fd=_0x1822f0[_0x539a('0x32')][_0x539a('0x45')];winston[_0x539a('0x23')](_0x539a('0x55'),_0x5a40fd);SubscriptionPayment[_0x539a('0x36')]({'project_id':_0x5a40fd,'stripe_event':'checkout.session.completed'},async function(_0x53aab5,_0xbc466a){if(_0x53aab5){winston[_0x539a('0x23')]('--\x20>\x20get\x20customer\x20from\x20db\x20-\x20Error\x20',_0x53aab5);return _0x53aab5;}if(_0xbc466a){_0xbc466a[0x0][_0x539a('0x7a')]['customer'];winston[_0x539a('0x23')](_0x539a('0x76'),_0xbc466a[0x0][_0x539a('0x7a')]['customer']);const _0x1be736=_0xbc466a[0x0][_0x539a('0x7a')][_0x539a('0x38')];const _0x541fa5=require(_0x539a('0x9f'))(apiSecretKey);const _0xbb103e=await _0x541fa5[_0x539a('0x52')][_0x539a('0x4f')](_0x1be736);winston[_0x539a('0x23')](_0x539a('0xa4'),_0xbb103e);const _0x25e308=await _0x541fa5[_0x539a('0x8d')]['list']({'customer':_0x1be736,'type':_0x539a('0x40')});_0xbb103e['paymentMethods']=_0x25e308;winston[_0x539a('0x23')](_0x539a('0x2a'),_0xbc466a);_0x65ae6f[_0x539a('0xa9')](_0xbb103e);}});});router[_0x539a('0x89')](_0x539a('0x9d'),[passport['authenticate'](['basic',_0x539a('0x57')],{'session':![]}),validtoken],async function(_0x40d91e,_0x34494a){var _0x1e3b8e=_0x40d91e[_0x539a('0x32')][_0x539a('0x29')];winston[_0x539a('0x23')](_0x539a('0x12'),_0x1e3b8e);winston[_0x539a('0x23')](_0x539a('0x1f'),_0x40d91e[_0x539a('0xa1')]);const _0x19bf26=require('stripe')(apiSecretKey);let _0x34931e;try{_0x34931e=await _0x19bf26[_0x539a('0x8d')][_0x539a('0x73')]({'type':_0x539a('0x40'),'card':{'number':_0x40d91e[_0x539a('0xa1')][_0x539a('0x6d')],'exp_month':_0x40d91e[_0x539a('0xa1')][_0x539a('0x79')],'exp_year':_0x40d91e[_0x539a('0xa1')][_0x539a('0x41')],'cvc':_0x40d91e[_0x539a('0xa1')][_0x539a('0x53')]}});}catch(_0x42d3b7){winston[_0x539a('0x4a')]('»»»\x20»»»\x20\x20paymentMethod\x20create\x20\x20error\x20',_0x42d3b7);return _0x34494a[_0x539a('0x2c')](0x1f6)[_0x539a('0x83')]({'success':![],'msg':_0x42d3b7});}winston[_0x539a('0x23')](_0x539a('0x99'),_0x34931e);try{const _0x2c123b=await _0x19bf26[_0x539a('0x8d')]['attach'](_0x34931e['id'],{'customer':_0x1e3b8e});winston[_0x539a('0x23')]('»»»\x20»»»\x20\x20paymentMethod\x20attached\x20',_0x2c123b);}catch(_0x514995){winston[_0x539a('0x4a')](_0x539a('0x5a'),_0x514995);return _0x34494a[_0x539a('0x2c')](0x1f5)[_0x539a('0x83')]({'success':![],'msg':_0x514995});}const _0x3555cc=await _0x19bf26[_0x539a('0x52')][_0x539a('0x85')](_0x1e3b8e,{'invoice_settings':{'default_payment_method':_0x34931e['id']}});_0x34494a[_0x539a('0xa9')](_0x3555cc);});router[_0x539a('0x44')](_0x539a('0x42'),[passport[_0x539a('0x6f')]([_0x539a('0x5f'),_0x539a('0x57')],{'session':![]}),validtoken],async function(_0xc02ac5,_0x28a309){winston[_0x539a('0x92')](_0x539a('0x58'),_0xc02ac5[_0x539a('0x32')]);var _0x2e21e8=_0xc02ac5[_0x539a('0x32')][_0x539a('0x29')];winston[_0x539a('0x23')](_0x539a('0x34'),_0x2e21e8);const _0x4a3ac5=require('stripe')(apiSecretKey);const _0x5dcd19=await _0x4a3ac5['customers'][_0x539a('0x4f')](_0x2e21e8);const _0x160ebd=_0x5dcd19[_0x539a('0x78')][_0x539a('0x35')];let _0x1d907d;try{_0x1d907d=await _0x4a3ac5[_0x539a('0x8d')]['list']({'customer':_0x2e21e8,'type':_0x539a('0x40')});winston[_0x539a('0x23')](_0x539a('0x9a'),_0x1d907d);}catch(_0x11dce0){return _0x28a309[_0x539a('0x2c')](0x1f5)['send']({'success':![],'msg':_0x11dce0});}winston[_0x539a('0x23')](_0x539a('0x60'),_0x160ebd);_0x1d907d[_0x539a('0x26')][_0x539a('0x2b')](_0x2027cb=>{if(_0x2027cb['id']!==_0x160ebd){winston[_0x539a('0x23')](_0x539a('0x18'),_0x2027cb['id']);detachPaymentFunc(_0x2027cb['id'],function(_0x539e00){winston[_0x539a('0x92')](_0x539a('0xa7'),_0x539e00);});}});_0x28a309[_0x539a('0xa9')](_0x1d907d);});async function detachPaymentFunc(_0x50c16c,_0x2841c1){winston[_0x539a('0x23')](_0x539a('0x8b'),_0x50c16c);const _0x4a577c=require(_0x539a('0x9f'))(apiSecretKey);let _0x56fddf;try{_0x56fddf=await _0x4a577c['paymentMethods'][_0x539a('0xb2')](_0x50c16c);_0x2841c1(_0x56fddf);}catch(_0xd4d49d){_0x2841c1(_0xd4d49d);}}module[_0x539a('0x7f')]=router;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBheW1lbnRzL3N0cmlwZS9pbmRleC5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIndpbnN0b24iLCJQcm9qZWN0IiwiU3Vic2NyaXB0aW9uUGF5bWVudCIsIm1vbWVudCIsIm1vbmdvb3NlIiwicGFzc3BvcnQiLCJ2YWxpZHRva2VuIiwiYXBpS2V5IiwicHJvY2VzcyIsInN0cmlwZSIsImVuZHBvaW50U2VjcmV0IiwiYXBpU2VjcmV0S2V5IiwiYm9keVBhcnNlciIsIl8weDE4MzczYSIsIl8weDQ5ZmQ0NiIsIl8weDNkOGVlMiIsIl8weDQ5YmVkMCIsIl8weDVmMWEwNCIsIl8weDQ5YjQ0NiIsIl8weDNjMzdhOSIsIl8weDM4NDhiOSIsIl8weDVlMzkyZCIsIl8weDRjMmE4MiIsIl8weDMzNTk5MCIsIl8weDQzYzg1MSIsIk51bWJlciIsIl8weDNjMjk1ZCIsImdldFN1YnNjcml0aW9uQnlJZCIsIl8weDEyYzlhOCIsIl8weDMwZTI0ZiIsIl8weDNmMWQ4NSIsIl8weDNkNTVmOSIsIl8weDk0YmJmMSIsInVwZGF0ZVByb2plY3RQcm9maWxlIiwic2F2ZU9uREIiLCJfMHgyMzM0MDUiLCJfMHhmZGI0MzAiLCJfMHgyYmM0NzEiLCJfMHg1MGM2OTAiLCJfMHgzNDJhNGQiLCJnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudCIsIl8weDEwOTBkMyIsIl8weDNhOTQ0ZCIsIl8weDNmN2ZkYiIsIl8weDU4NDY2OSIsIl8weDQ4ZTBhMyIsIl8weDRiNjQ5YiIsIl8weDFjYTM0YyIsIl8weDUwNjk0YiIsIl8weDY1YjQ5YyIsIl8weDQ3NzgyNSIsImNvbnNvbGUiLCJzYXZlRmlyc3RJbnZvaWNlUGF5bWVudFN1Y2NlZWRlZCIsIl8weDhlMjNjMCIsIl8weDM5M2E1OSIsIl8weDExNmIyZiIsIl8weDRjZDZmMSIsIl8weDRiNzM3MyIsIl8weDIzMzZhNCIsIl8weDUyZDU5MyIsIlByb21pc2UiLCJfMHgzYzAwN2QiLCJfMHgxMzRhYWEiLCJfMHgzNDdmNTkiLCJfMHg1YTJhMzMiLCJfMHgxOTUwMTUiLCJfMHgyOTAwMTMiLCJfMHgzOGZmZWYiLCJfMHg0NTkyODUiLCJfMHg1MmQzNWQiLCJfMHgyNjU0YTciLCJfMHgxNDM1NTciLCJfMHg1ZGZmYWYiLCJfMHgyMWUwNDkiLCJfMHg0MTgxYTAiLCJfMHg0ZDdiYjIiLCJfMHgzZWU1NTAiLCJfMHg0YTExZDYiLCJfMHg0NzYxZmMiLCJfMHgzNzBkNWUiLCJfMHg0NjVkY2MiLCJfMHgxNGFmM2MiLCJfMHg0YTg4NWMiLCJfMHgyODZiMTEiLCJfMHhjNjkyNTMiLCJfMHgxNjE3YzEiLCJfMHg0NjI2OGIiLCJyZXMiLCJfMHg0YTU2N2MiLCJfMHgzNWNiNDAiLCJfMHgzMGUwZTMiLCJfMHg0NWI3ODgiLCJfMHgzYWFlODYiLCJfMHgzNDFiYmUiLCJfMHgzZThlNGIiLCJfMHgxYzcyOWMiLCJfMHgyY2IwZGYiLCJfMHgzY2VhM2IiLCJfMHgyN2M5YmEiLCJfMHg1ZWRmN2MiLCJfMHhlOGMwMDMiLCJfMHgzM2I0ZDciLCJfMHg1ZTNmYjciLCJfMHg0NDdlYmQiLCJfMHg1YmM2MGMiLCJfMHgxZTcxNzIiLCJfMHgyODU1MjgiLCJfMHhhOWNhNjEiLCJfMHg0Y2Q5ZDAiLCJfMHgzNTViZGUiLCJfMHg1NTJlZTMiLCJfMHg0YWE1MzMiLCJfMHg1NDhiNCIsIl8weDViNTViMCIsIl8weDU3NmUyMyIsIl8weDEwMzVmNCIsIl8weDNkZjIxZSIsInByb2plY3QiLCJfMHg0ZDRhMDAiLCJfMHgzMzE5OGIiLCJfMHhkY2ViMzQiLCJfMHg1NmQ5OGMiLCJfMHgzM2U0NmUiLCJfMHg1ZjE3MGMiLCJfMHg0OTlmYjgiLCJfMHgxNDZmYTEiLCJfMHgyMGUzZDMiLCJfMHgxYjQ1Y2IiLCJfMHgxODIyZjAiLCJfMHg2NWFlNmYiLCJfMHg1YTQwZmQiLCJfMHg1M2FhYjUiLCJfMHhiYzQ2NmEiLCJfMHgxYmU3MzYiLCJfMHg1NDFmYTUiLCJfMHhiYjEwM2UiLCJfMHgyNWUzMDgiLCJfMHg0MGQ5MWUiLCJfMHgzNDQ5NGEiLCJfMHgxZTNiOGUiLCJfMHgxOWJmMjYiLCJfMHgzNDkzMWUiLCJfMHg0MmQzYjciLCJfMHgyYzEyM2IiLCJfMHg1MTQ5OTUiLCJfMHgzNTU1Y2MiLCJfMHhjMDJhYzUiLCJfMHgyOGEzMDkiLCJfMHgyZTIxZTgiLCJfMHg0YTNhYzUiLCJfMHg1ZGNkMTkiLCJfMHgxNjBlYmQiLCJfMHgxZDkwN2QiLCJfMHgxMWRjZTAiLCJfMHgyMDI3Y2IiLCJkZXRhY2hQYXltZW50RnVuYyIsIl8weDUzOWUwMCIsIl8weDUwYzE2YyIsIl8weDI4NDFjMSIsIl8weDRhNTc3YyIsIl8weDU2ZmRkZiIsIl8weGQ0ZDQ5ZCIsIm1vZHVsZSJdLCJtYXBwaW5ncyI6Iis3TEFBQSxJQUFJQSxPQUFBLENBQVVDLE9BQUEsQyxlQUFBLENBQWQsQ0FDQSxJQUFJQyxNQUFBLENBQVNGLE9BQUEsQyxjQUFBLEdBQWIsQ0FFQSxJQUFJRyxPQUFBLENBQVVGLE9BQUEsQyxlQUFBLENBQWQsQ0FFQSxJQUFJRyxPQUFBLENBQVVILE9BQUEsQyxlQUFBLENBQWQsQ0FDQSxJQUFJSSxtQkFBQSxDQUFzQkosT0FBQSxDLGVBQUEsQ0FBMUIsQ0FDQSxJQUFJSyxNQUFBLENBQVNMLE9BQUEsQyxRQUFBLENBQWIsQ0FDQSxJQUFJTSxRQUFBLENBQVdOLE9BQUEsQyxjQUFBLENBQWYsQ0FDQSxJQUFJTyxRQUFBLENBQVdQLE9BQUEsQyxlQUFBLENBQWYsQ0FFQUEsT0FBQSxDLGNBQUEsRUFBd0NPLFFBQXhDLEVBRUEsSUFBSUMsVUFBQSxDQUFhUixPQUFBLEMsZUFBQSxDQUFqQixDQUdBLE1BQU1TLE1BQUEsQ0FBU0MsT0FBQSxDLEtBQUEsRSx1QkFBQSxDQUFmLENBQ0FSLE9BQUEsQyxlQUFBLEUsZUFBYyxDQUFrQk8sTUFBaEMsRUFFQSxNQUFNRSxNQUFBLENBQVNYLE9BQUEsQyxlQUFBLEVBQWtCUyxNQUFsQixDQUFmLENBR0EsTUFBTUcsY0FBQSxDQUFpQkYsT0FBQSxDLEtBQUEsRSx1QkFBQSxDQUF2QixD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b0MsU0FBVUUsU0FBVixDQUFrQixDQUNwRDVKLE9BQUEsQyxlQUFBLEUsZUFBQSxDQUEwQzRKLFNBQTFDLEVBRG9ELENBQXRELEVBRmtELENBRFQsQ0FBN0MsRUFRQVQsU0FBQSxDLGVBQUEsRUFBU0ssU0FBVCxFQS9COEksQ0FBaEosRUFrQ0EsZUFBZUcsaUJBQWYsQ0FBaUNFLFNBQWpDLENBQWtEQyxTQUFsRCxDQUE0RCxDQUMxRDlKLE9BQUEsQyxlQUFBLEUsZUFBQSxDQUF1RDZKLFNBQXZELEVBQ0EsTUFBTUUsU0FBQSxDQUFTakssT0FBQSxDLGVBQUEsRUFBa0JhLFlBQWxCLENBQWYsQ0FDQSxJQUFJcUosU0FBSixDQUNBLEdBQUksQ0FDRkEsU0FBQSxDQUFnQixNQUFNRCxTQUFBLEMsZ0JBQUEsRSxlQUFBLEVBQ3BCRixTQURvQixDQUF0QixDQUdBQyxTQUFBLENBQVNFLFNBQVQsRUFKRSxDQUtGLE1BQU9DLFNBQVAsQ0FBVSxDQUNWSCxTQUFBLENBQVNHLFNBQVQsRUFEVSxDQVQ4QyxDQWlENURDLE1BQUEsQyxlQUFBLEVBQWlCbkssTUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbnZhciByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuLy8gdmFyIHdpbnN0b24gPSByZXF1aXJlKCcuLi8uLi8uLi8uLi9jb25maWcvd2luc3RvbicpO1xudmFyIHdpbnN0b24gPSByZXF1aXJlKCcuLi8uLi8uLi9jb25maWcvd2luc3RvbicpXG4vLyB2YXIgUHJvamVjdCA9IHJlcXVpcmUoXCIuLi8uLi8uLi8uLi9tb2RlbHMvcHJvamVjdFwiKTtcbnZhciBQcm9qZWN0ID0gcmVxdWlyZShcIi4uLy4uLy4uL21vZGVscy9wcm9qZWN0XCIpO1xudmFyIFN1YnNjcmlwdGlvblBheW1lbnQgPSByZXF1aXJlKFwiLi4vbW9kZWxzL3N1YnNjcmlwdGlvbi1wYXltZW50XCIpO1xudmFyIG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpO1xudmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcbnZhciBwYXNzcG9ydCA9IHJlcXVpcmUoJ3Bhc3Nwb3J0Jyk7XG4vLyByZXF1aXJlKCcuLi8uLi8uLi8uLi9taWRkbGV3YXJlL3Bhc3Nwb3J0JykocGFzc3BvcnQpO1xucmVxdWlyZShcIi4uLy4uLy4uL21pZGRsZXdhcmUvcGFzc3BvcnRcIikocGFzc3BvcnQpO1xuLy8gdmFyIHZhbGlkdG9rZW4gPSByZXF1aXJlKCcuLi8uLi8uLi8uLi9taWRkbGV3YXJlL3ZhbGlkLXRva2VuJylcbnZhciB2YWxpZHRva2VuID0gcmVxdWlyZSgnLi4vLi4vLi4vbWlkZGxld2FyZS92YWxpZC10b2tlbicpXG4vLyBTZXQgeW91ciBzZWNyZXQga2V5OiByZW1lbWJlciB0byBjaGFuZ2UgdGhpcyB0byB5b3VyIGxpdmUgc2VjcmV0IGtleSBpbiBwcm9kdWN0aW9uXG4vLyBTZWUgeW91ciBrZXlzIGhlcmU6IGh0dHBzOi8vZGFzaGJvYXJkLnN0cmlwZS5jb20vYWNjb3VudC9hcGlrZXlzXG5jb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5QQVlNRU5UX1NUUklQRV9BUElLRVk7XG53aW5zdG9uLmRlYnVnKCdzdHJpcGUgYXBpS2V5JyArIGFwaUtleSk7XG5cbmNvbnN0IHN0cmlwZSA9IHJlcXVpcmUoJ3N0cmlwZScpKGFwaUtleSk7XG5cbi8vIEZpbmQgeW91ciBlbmRwb2ludCdzIHNlY3JldCBpbiB5b3VyIERhc2hib2FyZCdzIHdlYmhvb2sgc2V0dGluZ3NcbmNvbnN0IGVuZHBvaW50U2VjcmV0ID0gcHJvY2Vzcy5lbnYuUEFZTUVOVF9TVFJJUEVfU0VDUkVUO1xud2luc3Rvbi5kZWJ1Zygnc3RyaXBlIGVuZHBvaW50U2VjcmV0JyArIGVuZHBvaW50U2VjcmV0KTtcblxuY29uc3QgYXBpU2VjcmV0S2V5ID0gcHJvY2Vzcy5lbnYuUEFZTUVOVF9TVFJJUEVfQVBJX1NFQ1JFVF9LRVk7XG53aW5zdG9uLmRlYnVnKCdzdHJpcGUgYXBpU2VjcmV0S2V5JyArIGFwaVNlY3JldEtleSk7XG5cbmNvbnN0IGJvZHlQYXJzZXIgPSByZXF1aXJlKCdib2R5LXBhcnNlcicpO1xuXG4vLyBodHRwczovL3N0cmlwZS5jb20vZG9jcy9wYXltZW50cy9jaGVja291dC9mdWxmaWxsbWVudCN3ZWJob29rc1xuLy8gY3VybCAtWCBQT1NUIC11IGFuZHJlYS5sZW9AZjIxLml0OjEyMzQ1NiAtSCAnQ29udGVudC1UeXBlOmFwcGxpY2F0aW9uL2pzb24nIC1kICd7XCJ0eXBlXCI6XCJwYXltZW50X2ludGVudC5zdWNjZWVkZWRcIn0nICBodHRwOi8vbG9jYWxob3N0OjMwMDAvbW9kdWxlcy9wYXltZW50cy9zdHJpcGUvd2ViaG9va1xucm91dGVyLnBvc3QoJy93ZWJob29rJywgYm9keVBhcnNlci5yYXcoeyB0eXBlOiAnYXBwbGljYXRpb24vanNvbicgfSksIGZ1bmN0aW9uIChyZXF1ZXN0LCByZXNwb25zZSkge1xuICBcbiAgd2luc3Rvbi5kZWJ1ZygnwrvCu8K7wrsgc3RyaXBlIGVuZHBvaW50U2VjcmV0OiAnICsgZW5kcG9pbnRTZWNyZXQpXG4gIHdpbnN0b24uZGVidWcoJ8K7wrvCu8K7IHN0cmlwZSBhcGlLZXk6ICcgKyBhcGlLZXkpO1xuICB3aW5zdG9uLmRlYnVnKCdzdHJpcGUgYXBpU2VjcmV0S2V5JyArIGFwaVNlY3JldEtleSk7XG5cbiAgY29uc3Qgc2lnID0gcmVxdWVzdC5oZWFkZXJzWydzdHJpcGUtc2lnbmF0dXJlJ107XG5cbiAgd2luc3Rvbi5kZWJ1Zygnc3RyaXBlIHNpZzogJywgc2lnKVxuXG4gIGxldCBldmVudDtcblxuICB0cnkge1xuICAgIGV2ZW50ID0gc3RyaXBlLndlYmhvb2tzLmNvbnN0cnVjdEV2ZW50KHJlcXVlc3QucmF3Qm9keSwgc2lnLCBlbmRwb2ludFNlY3JldCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHdpbnN0b24uZXJyb3IoJyoqKiogU3RyaXBlIGVycm9yIGNvbnN0cnVjdEV2ZW50OiAnLCBlcnIubWVzc2FnZSlcbiAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzKDQwMCkuc2VuZChgV2ViaG9vayBFcnJvcjogJHtlcnIubWVzc2FnZX1gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiohICoqKiBIYW5kbGUgdGhlIGNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkIGV2ZW50ICoqKlxuICAgKiBOT1RFOiBUSElTIEVWRU5UIE9DQ1VSIE9OTFkgV0hFTiBJUyBDUkVBVEVEIEEgTkVXIFNVQlNDUklQVElPTlxuICAgKiAxKSBGUk9NIFRIRSBQUk9QRVJUWSBcImNsaWVudF9yZWZlcmVuY2VfaWRcIiBBUkUgT0JUQUlORUQgVEhFOlxuICAgKiAgICBBKSBVU0VSIElEXG4gICAqICAgIEIpIFBST0pFQ1QgSUQgXG4gICAqIDIpIFdJVEggVEhFIHN1YnNjcmlwdGlvbiBJRCAoTk9URSBpcyB0aGUgcHJvcGVydHkgc3Vic2NyaXB0aW9uKSBJUyBSVU5ORUQgQSBDQUxMQkFDSyBUTyBTVFJJUEVcbiAgICogICAgVE8gT0JUQUlOIFRIRSBPQkpFQ1QgXCJTVUJTQ1JJUFRJT05cIiBBTkQgVEhFTiBGUk9NIFRISVMgQVJFIE9CVEFJTkVEIFRIRTpcbiAgICogICAgQSkgc3Vic2NyaXB0aW9uU3RhcnREYXRlXG4gICAqICAgIEIpIHN1YnNjcmlwdGlvbkVuZERhdGVcbiAgICogICAgQykgcXVhbnRpdHkgKHdoaWNoIGluIHRoZSB0aWxlZGVzayBkYXNoYm9hcmQgY29ycmVzcG9uZHMgdG8gdGhlIG51bWJlciBvZiBhZ2VudHMgLyBvcGVyYXRvcnMgc2VhdHMpXG4gICAqIDMpIFdJVEggVEhFIE9CVEFJTkVEIERBVEEgSVMgVVBEQVRFRCBUSEUgUFJPSkVDVCAnUFJPRklMRScgKGlzIGFuIG9iamVjdCBuZXN0ZWQgaW4gdGhlIHByb2plY3Qgb2JqZWN0KSBcbiAgICogNCkgVEhFIE9CVEFJTkVEIE9CSkVDVCBcIlNVQlNDUklQVElPTlwiIEFORCB0aGUgXCJTVUJTQ1JJUFRJT04gSURcIiwgdGhlIFwiUFJPSkVDVCBJRFwiLCB0aGUgXCJVU0VSIElEXCIgQU5EIHN0cmlwZV9ldmVudDogXCJjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZFwiIEFSRSBTQVZFRCBPTiBPVVIgREJcbiAgICogICAgQVMgXCJTVUJTQ1JJUFRJT04tUEFZTUVOVFwiXG4gICAqL1xuXG4gIGlmIChldmVudC50eXBlID09PSAnY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWQnKSB7XG4gICAgd2luc3Rvbi5kZWJ1ZygnISEhISEhISEgSEkgISEhISEhISEgY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWQnKTtcblxuICAgIGNvbnN0IHNlc3Npb24gPSBldmVudC5kYXRhLm9iamVjdDtcbiAgICB3aW5zdG9uLmluZm8oJ3N0cmlwZSBjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZCcsIHNlc3Npb24pO1xuXG4gICAgdmFyIGNsaWVudF9yZWZlcmVuY2VfaWQgPSBzZXNzaW9uLmNsaWVudF9yZWZlcmVuY2VfaWQ7XG4gICAgd2luc3Rvbi5pbmZvKCdzdHJpcGUgY2xpZW50X3JlZmVyZW5jZV9pZCcsIGNsaWVudF9yZWZlcmVuY2VfaWQpO1xuXG4gICAgLyoqIDFBICovXG4gICAgdmFyIHVzZXJfaWQgPSBjbGllbnRfcmVmZXJlbmNlX2lkLnNwbGl0KFwiX1wiKVswXTtcbiAgICB3aW5zdG9uLmluZm8oJ3N0cmlwZSB1c2VyX2lkOicgKyB1c2VyX2lkKTtcblxuICAgIC8qKiAxQiAqL1xuICAgIHZhciBwcm9qZWN0X2lkID0gY2xpZW50X3JlZmVyZW5jZV9pZC5zcGxpdChcIl9cIilbMV07XG4gICAgd2luc3Rvbi5pbmZvKCdzdHJpcGUgcHJvamVjdF9pZDogJyArIHByb2plY3RfaWQpO1xuXG4gICAgdmFyIHBsYW5fbmFtZSA9IGNsaWVudF9yZWZlcmVuY2VfaWQuc3BsaXQoXCJfXCIpWzJdO1xuICAgIHdpbnN0b24uaW5mbygnc3RyaXBlIHBsYW5fbmFtZTogJyArIHBsYW5fbmFtZSk7XG5cbiAgICB2YXIgc2VhdHNfbnVtQXNTdHJpbmcgPSBjbGllbnRfcmVmZXJlbmNlX2lkLnNwbGl0KFwiX1wiKVszXTtcbiAgICB3aW5zdG9uLmluZm8oJ3N0cmlwZSBzZWF0c19udW06ICcgKyBzZWF0c19udW1Bc1N0cmluZyArICd0eXBlb2YgJywgdHlwZW9mIHNlYXRzX251bUFzU3RyaW5nKTtcblxuICAgIHZhciBzZWF0c19udW0gPSBOdW1iZXIoc2VhdHNfbnVtQXNTdHJpbmcpXG4gICAgd2luc3Rvbi5pbmZvKCdzdHJpcGUgc2VhdHNfbnVtQXNTdHJpbmc6ICcgKyBzZWF0c19udW0gKyAnIHR5cGVvZiAnLCB0eXBlb2Ygc2VhdHNfbnVtKTtcblxuICAgIHZhciBzdWJzY3JpcHRpb25JZCA9IGV2ZW50LmRhdGEub2JqZWN0LnN1YnNjcmlwdGlvbjtcbiAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogISEhISEhISEhISEhISEhISEhISEhISBjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZCAtIHN1YnNjcmlwdGlvbiBJRDogJywgc3Vic2NyaXB0aW9uSWQpO1xuXG4gICAgZ2V0U3Vic2NyaXRpb25CeUlkKHN1YnNjcmlwdGlvbklkKS50aGVuKGZ1bmN0aW9uIChzdWJzY3JpcHRpb25fb2JqKSB7XG5cbiAgICAgIHZhciBvYmplY3RfdHlwZSA9IHN1YnNjcmlwdGlvbl9vYmoub2JqZWN0O1xuICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkIC0gZ2V0U3Vic2NyaXRpb25CeUlkIHN1YnNjciBvYmplY3RfdHlwZTogJywgb2JqZWN0X3R5cGUpO1xuXG4gICAgICAvKiogMkEgKi9cbiAgICAgIHZhciBzdWJzY3JpcHRpb25TdGFydERhdGUgPSBtb21lbnQudW5peChzdWJzY3JpcHRpb25fb2JqLmN1cnJlbnRfcGVyaW9kX3N0YXJ0KS5mb3JtYXQoJ1lZWVktTU0tRERUSEg6bW06c3MuU1NTJylcbiAgICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZCAtIGdldFN1YnNjcml0aW9uQnlJZCAqKiogc3RhcnQgKioqIDogJywgc3Vic2NyaXB0aW9uU3RhcnREYXRlKTtcblxuICAgICAgLyoqIDJCICovXG4gICAgICB2YXIgc3Vic2NyaXB0aW9uRW5kRGF0ZSA9IG1vbWVudC51bml4KHN1YnNjcmlwdGlvbl9vYmouY3VycmVudF9wZXJpb2RfZW5kKS5mb3JtYXQoJ1lZWVktTU0tRERUSEg6bW06c3MuU1NTJylcbiAgICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZCAtIGdldFN1YnNjcmlwdGlvbiAqKiogZW5kICoqKiA6ICcsIHN1YnNjcmlwdGlvbkVuZERhdGUpO1xuXG4gICAgICAvKipcbiAgICAgICAqISAqKiogQk9EWSAqKipcbiAgICAgICAqL1xuICAgICAgdmFyIGJvZHkgPSB7XG4gICAgICAgIHByb2ZpbGU6IHtcbiAgICAgICAgICBuYW1lOiBwbGFuX25hbWUsXG4gICAgICAgICAgdHlwZTogJ3BheW1lbnQnLFxuICAgICAgICAgIHN1YnNjcmlwdGlvbl9jcmVhdGlvbl9kYXRlOiBzdWJzY3JpcHRpb25TdGFydERhdGUsXG4gICAgICAgICAgc3ViU3RhcnQ6IHN1YnNjcmlwdGlvblN0YXJ0RGF0ZSxcbiAgICAgICAgICBzdWJFbmQ6IHN1YnNjcmlwdGlvbkVuZERhdGUsXG4gICAgICAgICAgc3Vic2NyaXB0aW9uSWQ6IHN1YnNjcmlwdGlvbklkLFxuICAgICAgICAgIGxhc3Rfc3RyaXBlX2V2ZW50OiBldmVudC50eXBlLFxuICAgICAgICAgIGFnZW50czogc2VhdHNfbnVtXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLyoqIDMgKi9cbiAgICAgIHVwZGF0ZVByb2plY3RQcm9maWxlKHByb2plY3RfaWQsIGJvZHksICdjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZCcpO1xuXG4gICAgICAvKiogNCAqL1xuICAgICAgc2F2ZU9uREIoc3Vic2NyaXB0aW9uSWQsIHByb2plY3RfaWQsIHN1YnNjcmlwdGlvbl9vYmosIHVzZXJfaWQsIGV2ZW50LnR5cGUsIHBsYW5fbmFtZSwgc2VhdHNfbnVtKVxuXG4gICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgd2luc3Rvbi5lcnJvcignKioqICoqKiBjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZCAtIGdldFN1YnNjcml0aW9uQnlJZCBlcnIgJywgZXJyKTtcbiAgICB9KTtcblxuICB9XG4gIC8vIG9iamVjdF90eXBlID0gc3Vic2NyaXB0aW9uLlxuICAvKipcbiAgICoqISAqKiogSGFuZGxlIHRoZSBpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkIGV2ZW50ICoqKlxuICAgKiBOT1RFOiBUSElTIEVWRU5UIE9DQ1VSIFdIRU4gSVMgQ1JFQVRFRCBBIE5FVyBTVUJTQ1JJUFRJT04gQU5EIEVWRVJZIFRJTUUgVEhFIFNBTUUgSVMgUkVORVdFRFxuICAgKiAxKSBGUk9NIFRIRSBPQkpFQ1QgT0YgVEhFIEVWRU5UIEFSRSBPQlRBSU5FRCBUSEU6XG4gICAqICAgIEEpIHN1YnNjcmlwdGlvblN0YXJ0RGF0ZVxuICAgKiAgICBCKSBzdWJzY3JpcHRpb25FbmREYXRlXG4gICAqICAgIEMpIHN1YnNjcml0cHRpb25JZCAgXG4gICAqIDIpIHdoZW4gcmVmZXIgdG8gYSBSRU5FV0FMICggYmlsbGluZ19yZWFzb24gPT09IHN1YnNjcmlwdGlvbl9jeWNsZSlcbiAgICogICAgSUYgVEhFIFZBTFVFIE9GIFRIRSBQUk9QRVJUWSBcImJpbGxpbmdfcmVhc29uXCIgSVMgVU5MSUtFIE9GIFwic3Vic2NyaXB0aW9uX2NyZWF0ZVwiIChNRUFOUyBUSEFUIFRIRSBFVkVOVCBSRUZFUiBUTyBBIFJFTkVXQUwgXG4gICAqICAgIEZPUiBXSElDSCBiaWxsaW5nX3JlYXNvbjogc3Vic2NyaXB0aW9uX2N5Y2xlIEFORCBOT1QgVE8gVEhFIEZJUlNUIFNVQlNDUklQVElPTikgXG4gICAqICAgIEEpIElTIE9CVEFJTkVEIFRIRSAnU1VCU0NSSVBUSU9OLVBBWU1FTlQnICh3aXRoIHN0cmlwZV9ldmVudDogXCJjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZFwiKSBTQVZFRCBBQk9WRSBBTkQgVEhFTiBGUk9NIFRISVM6XG4gICAqICAgICAgIC0gVEhFIFwiUFJPSkVDVCBJRFwiIFxuICAgKiAgICAgICAtIFRIRSBcIlVTRVIgSURcIlxuICAgKiAgICAgICBUTyBPQlRBSU4gVEhFICdTVUJTQ1JJUFRJT04tUEFZTUVOVCdJTiBPVVIgREIgSVMgTE9PS0VEIEZPUiBUSEUgXCJTVUJTQ1JJUElPTi1QQVlNRU5UXCIgVEhBVCBIQVMgRk9SIHN1YnNjcmlwdGlvbiBpZCBUSEUgVkFMVUUgT0YgMUMgQU5EIHN0cmlwZV9ldmVudDogXCJjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZFwiXG4gICAqICAgICAgIFRIRSBDT05ESVRJT04gc3RyaXBlX2V2ZW50OiBcImNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkXCIgKE5PIE1PUkU6IG9iamVjdF90eXBlID0gc3Vic2NyaXB0aW9uKSBJVCdTIE5FQ0VTU0FSWSBUTyBGSUxURVIgVEhFIFwiU1VCU0NSSVBJT04tUEFZTUVOVFNcIiBcbiAgICogICAgICAgVEhBVCBDT05UQUlOIFRIRSAgUFJPUEVSVElFUyAgXCJwcm9qZWN0SURcIiBBTkQgXCJ1c2VySURcIlxuICAgKiAgICAgICBUSEUgRVhJU1RFTkNFIE9GIEEgXCJTVUJTQ1JJUFRJT04tUEFZTUVOVFwiIFdJVEhPVVQgXCJwcm9qZWN0SURcIiBBTkQgXCJ1c2VySURcIiBJUyBEVUUgVE8gVEhFIEZBQ1QgVEhBVCBBVCBUSEUgTU9NRU5UIE9GIFRIRSBDUkVBVElPTiBPRiBBIFNVQlNDUklQVElPTiBcbiAgICogICAgICAgSVMgU0FWRUQgSU4gT1VSIERCIEFMU08gQSBcIlNVQlNDUklQVElPTi1QQVlNRU5UXCIgQ09SUkVTUE9ORElORyBUTyBUSEUgT0JKRUNUIFJFVFVSTkVEIEJZICBUSEUgRVZFTlQgXCJpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkXCIgVVNFRlVMIEJFQ0FVU0UgXG4gICAqICAgICAgIElUIENPTlRBSU5TIFRIRSBMSU5LUyBPRiBUSEUgSU5WT0lDRSBPRiBUSEUgRklSU1QgU1VCU0NSSVBUSU9OICh1c2VkIGJ5IHRpbGVkZXNrIGRhc2hib2FyZCBpbiB0aGUgY29tcG9uZW50cyBwYXltZW50cylcbiAgICogICAgICAgQlVUIEZST00gV0hJQ0ggSVQgSVMgTk9UIFBPU1NJQkxFIFBVU0ggQU5EIFRIRU4gVE8gVE8gT0JUQUlOIFRIRSBcInByb2plY3RJRFwiIEFORCBcInVzZXJJRFwiXG4gICAqICAgIEIpIElTIFVQREFURUQgVEhFIFBST0pFQ1QgJ1BST0ZJTEUnIFdJVEg6XG4gICAqICAgICAgIC0gREFUQSBPQlRBSU5FRCBGUk9NIFRIRSBFVkVOVCdTIE9CSkVDVDpcbiAgICogICAgICAgICAtIHN1YnNjcmlwdGlvblN0YXJ0RGF0ZVxuICAgKiAgICAgICAgIC0gc3Vic2NyaXB0aW9uRW5kRGF0ZVxuICAgKiAgICAgICAgIC0gc3Vic2NyaXB0aW9uSWQgXG4gICAqICAgICAgICAgLSBsYXN0X3N0cmlwZV9ldmVudCBcbiAgICogICAgICAgICAtIHF1YW50aXR5ICh3aGljaCBpbiB0aGUgZGFzaGJvYXJkIGNvcnJlc3BvbmRzIHRvIHRoZSBudW1iZXIgb2YgYWdlbnRzIC8gb3BlcmF0b3JzIHNlYXRzKVxuICAgKiAgICAgICAtIERBVEEgT0JUQUlORUQgRlJPTSBUSEUgJ1NVQlNDUklQVElPTi1QQVlNRU5UJyB3aXRoIHN0cmlwZV9ldmVudDogXCJjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZFwiXG4gICAqICAgICAgICAgLSBcIlBST0pFQ1QgSURcIiBhbmQgXCJVU0VSIElEXCJcbiAgICogICAgQykgVEhFIE9CSkVDVCBPRiBUSEUgRVZFTlQgaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCBBTkQgdGhlIFwiU1VCU0NSSVBUSU9OIElEXCIsIHRoZSBcIlBST0pFQ1QgSURcIiwgdGhlIFwiVVNFUiBJRFwiIEFORCB0aGUgXCJPQkpFQ1RfVFlQRVwiIChldmVudCkgXG4gICAqICAgICAgIEFSRSBTQVZFRCBBUyBcIlNVQlNDUklQVElPTi1QQVlNRU5UXCIgT04gT1VSIERCXG4gICAqIDMpIHdoZW4gcmVmZXIgdG8gYSBDUkVBVElPTiAoYmlsbGluZ19yZWFzb24gPT09IHN1YnNjcmlwdGlvbl9jcmVhdGUpXG4gICAqICAgIEEpIFRIRSBPQkpFQ1QgT0YgVEhFIEVWRU5UIGludm9pY2UucGF5bWVudF9zdWNjZWVkZWQgQU5EIFRIRSBEQVRBIGV2ZW50LnR5cGUgPT09IGludm9pY2UucGF5bWVudF9zdWNjZWVkZWQgIEFSRSBTQVZFRCBBUyBcIlNVQlNDUklQVElPTi1QQVlNRU5UXCJcbiAgICogICAgICAgT04gT1VSIERCIChOT1RFOiBcIlBST0pFQ1QgSURcIiBBTkQgXCJVU0VSIElEXCIgQVJFIFNBVkVEIEFTIG51bGwgU0lOQ0UgSVMgTk9UIFBPU1NJQkxFIFRPIFJFVFJJRVZFIFRIRSBWQUxVRVMpIFxuICAgKiBcbiAgICovXG4gIGlmIChldmVudC50eXBlID09PSAnaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCcpIHtcblxuICAgIHdpbnN0b24uaW5mbygnICEhISEhISEhIEhJICEhISEhISEhIGludm9pY2UucGF5bWVudF9zdWNjZWVkZWQnKTtcbiAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCAtIEJJTExJTkcgUkVBU09OICcsIGV2ZW50LmRhdGEub2JqZWN0LmJpbGxpbmdfcmVhc29uKTtcblxuICAgIHZhciBsaW5lc051bSA9IGV2ZW50LmRhdGEub2JqZWN0LmxpbmVzLnRvdGFsX2NvdW50XG4gICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGludm9pY2UucGF5bWVudF9zdWNjZWVkZWQgLSBsaW5lc051bTogJywgbGluZXNOdW0pO1xuXG4gICAgdmFyIGluZGV4ID0gbGluZXNOdW0gLSAxO1xuICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkIC0gaW5kZXg6ICcsIGluZGV4KTtcblxuICAgIC8qKiAxQSAqLyAvLyBUSElTIFdPUktTXG4gICAgdmFyIHN1YnNjcmlwdGlvblN0YXJ0RGF0ZSA9IG1vbWVudC51bml4KGV2ZW50LmRhdGEub2JqZWN0LmxpbmVzLmRhdGFbaW5kZXhdLnBlcmlvZC5zdGFydCkuZm9ybWF0KCdZWVlZLU1NLUREVEhIOm1tOnNzLlNTUycpXG4gICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGludm9pY2UucGF5bWVudF9zdWNjZWVkZWQgLSBzdGFydDogJywgc3Vic2NyaXB0aW9uU3RhcnREYXRlKTtcblxuICAgIC8qKiAxQiAqLyAvLyBUSElTIFdPUktTXG4gICAgdmFyIHN1YnNjcmlwdGlvbkVuZERhdGUgPSBtb21lbnQudW5peChldmVudC5kYXRhLm9iamVjdC5saW5lcy5kYXRhW2luZGV4XS5wZXJpb2QuZW5kKS5mb3JtYXQoJ1lZWVktTU0tRERUSEg6bW06c3MuU1NTJylcbiAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCAtIGVuZDogJywgc3Vic2NyaXB0aW9uRW5kRGF0ZSk7XG5cbiAgICB2YXIgc3Vic2NyaXB0aW9uSWQgPSBldmVudC5kYXRhLm9iamVjdC5zdWJzY3JpcHRpb247XG4gICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGludm9pY2UucGF5bWVudF9zdWNjZWVkZWQgLSBzdWJzY3JpcHRpb24gSUQ6ICcsIHN1YnNjcmlwdGlvbklkKTtcblxuICAgIGlmIChzdWJzY3JpcHRpb25JZCA9PSBudWxsKSB7XG4gICAgICBzdWJzY3JpcHRpb25JZCA9IGV2ZW50LmRhdGEub2JqZWN0LmxpbmVzLmRhdGFbMF0uc3Vic2NyaXB0aW9uO1xuICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGludm9pY2UucGF5bWVudF9zdWNjZWVkZWQgLSBzdWJzY3JpcHRpb24gSUQ6ICcsIHN1YnNjcmlwdGlvbklkKTtcbiAgICB9XG5cbiAgICBpZiAoZXZlbnQuZGF0YS5vYmplY3QuYmlsbGluZ19yZWFzb24gIT09ICdzdWJzY3JpcHRpb25fY3JlYXRlJykge1xuXG5cbiAgICAgIC8vIFRPIFRFU1QgVEhFIFJFTkVXQUwgVU5DT01NRU5UIFNFVCBUSU1FT1VUXG4gICAgICAvLyBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIC8qKiAyQSAqL1xuICAgICAgZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQoc3Vic2NyaXB0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHN1YnNwdG5fcGF5bWVudCkge1xuICAgICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgc3Vic3B0bl9wYXltZW50OiAnLCBzdWJzcHRuX3BheW1lbnQpO1xuICAgICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgc3Vic3B0bl9wYXltZW50IHR5cGVvZiBzdWJzcHRuX3BheW1lbnQ6ICcsIHR5cGVvZiBzdWJzcHRuX3BheW1lbnQpO1xuICAgICAgICBpZiAoc3Vic3B0bl9wYXltZW50KSB7XG5cbiAgICAgICAgICB2YXIgcHJvamVjdElkID0gc3Vic3B0bl9wYXltZW50LnByb2plY3RfaWRcbiAgICAgICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgc3Vic3B0bl9wYXltZW50ID4gcHJvamVjdF9pZDogJywgcHJvamVjdElkKTtcblxuICAgICAgICAgIFByb2plY3QuZmluZE9uZSh7IF9pZDogcHJvamVjdElkIH0sIGZ1bmN0aW9uIChlcnIsIHByb2plY3QpIHtcbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGdldFN1YkJ5SWRBbmRDaGVja291dFNlc3Npb25Db21wbGV0ZWRFdm50ICBmaW5kIFByb2plY3QgJywgZXJyKTtcbiAgICAgICAgICAgICAgcmV0dXJuIChlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByb2plY3QpIHtcbiAgICAgICAgICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGdldFN1YkJ5SWRBbmRDaGVja291dFNlc3Npb25Db21wbGV0ZWRFdm50ICBwcm9qZWN0ICcsIHByb2plY3QpO1xuICAgICAgICAgICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgIHByb2plY3QgPiBwcm9maWxlJywgcHJvamVjdC5wcm9maWxlKTtcblxuICAgICAgICAgICAgICB2YXIgc2VhdHNfbnVtID0gcHJvamVjdC5wcm9maWxlLmFnZW50cztcbiAgICAgICAgICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGdldFN1YkJ5SWRBbmRDaGVja291dFNlc3Npb25Db21wbGV0ZWRFdm50ICBwcm9qZWN0ID4gcHJvZmlsZSA+IGFnZW50cycsIHNlYXRzX251bSk7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICB2YXIgcGxhbl9uYW1lID0gcHJvamVjdC5wcm9maWxlLm5hbWU7XG4gICAgICAgICAgICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudCAgcHJvamVjdCA+IHByb2ZpbGUgPiBhZ2VudHMgdHlwZW9mJywgdHlwZW9mIHNlYXRzX251bSk7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICB2YXIgdXNlcklkID0gc3Vic3B0bl9wYXltZW50LnVzZXJfaWRcbiAgICAgICAgICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGdldFN1YkJ5SWRBbmRDaGVja291dFNlc3Npb25Db21wbGV0ZWRFdm50ICBwcm9qZWN0ID4gcHJvZmlsZSA+IG5hbWUnLCBwbGFuX25hbWUpO1xuXG4gICAgICAgICAgICAgIHZhciBwcm9maWxlX3F1b3RlcyA9IHByb2plY3QucHJvZmlsZS5xdW90ZXM7XG5cbiAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAgLy8gIEJPRFkgXG4gICAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgIHZhciBib2R5ID0ge1xuICAgICAgICAgICAgICAgIHByb2ZpbGU6IHtcbiAgICAgICAgICAgICAgICAgIG5hbWU6IHBsYW5fbmFtZSxcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdwYXltZW50JyxcbiAgICAgICAgICAgICAgICAgIHN1YlN0YXJ0OiBzdWJzY3JpcHRpb25TdGFydERhdGUsXG4gICAgICAgICAgICAgICAgICBzdWJFbmQ6IHN1YnNjcmlwdGlvbkVuZERhdGUsXG4gICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25JZDogc3Vic2NyaXB0aW9uSWQsXG4gICAgICAgICAgICAgICAgICBsYXN0X3N0cmlwZV9ldmVudDogZXZlbnQudHlwZSxcbiAgICAgICAgICAgICAgICAgIGFnZW50czogc2VhdHNfbnVtLFxuICAgICAgICAgICAgICAgICAgcXVvdGVzOiBwcm9maWxlX3F1b3Rlc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIC8qKiAyQiAqL1xuICAgICAgICAgICAgICB1cGRhdGVQcm9qZWN0UHJvZmlsZShwcm9qZWN0SWQsIGJvZHksICdpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkJyk7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAvKiogMkMgKi9cbiAgICAgICAgICAgICAgc2F2ZU9uREIoc3Vic2NyaXB0aW9uSWQsIHByb2plY3RJZCwgZXZlbnQsIHVzZXJJZCwgZXZlbnQudHlwZSwgcGxhbl9uYW1lLCBzZWF0c19udW0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICB3aW5zdG9uLmVycm9yKCcqKiogKioqIGdldFN1YkJ5SWRBbmRDaGVja291dFNlc3Npb25Db21wbGV0ZWRFdm50IC0gZXJyICcsIGVycik7XG4gICAgICB9KTtcbiAgICAgIC8vIH0sIDUwMDApO1xuICAgIH0gXG4gICAgZWxzZSBpZiAoZXZlbnQuZGF0YS5vYmplY3QuYmlsbGluZ19yZWFzb24gPT09ICdzdWJzY3JpcHRpb25fY3JlYXRlJykge1xuICAgICAgY29uc29sZS5sb2coJ1VTRUNBU0UgIGludm9pY2UucGF5bWVudF9zdWNjZWVkZWQgIGJpbGxpbmdfcmVhc29uIHN1YnNjcmlwdGlvbl9jcmVhdGUgJykgXG4gICAgICBzYXZlRmlyc3RJbnZvaWNlUGF5bWVudFN1Y2NlZWRlZChzdWJzY3JpcHRpb25JZCwgZXZlbnQsIGV2ZW50LnR5cGUpO1xuICAgIH0gXG4gIFxuICB9XG5cbiAgLyoqXG4gICAqKiEgKioqIEhBTkRMRSBUSEUgRVZFTlQgY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQgKioqXG4gICAqIHRoaXMgZXZlbnQgb2NjdXJzIHdoZW4gYSBzdWJzY3JpcHRpb24gaXMgY2FuY2VsbGVkXG4gICAqIC0gZnJvbSB0aGUgVElMRURFU0snIGRhc2hib2FyZCAoYnkgY2xpY2tpbmcgQ0FOQ0VMIFNVQlNDUklQVElPTiB0aGF0IGNhbGwgY2FuY2Vsc3Vic2NyaXB0aW9uKCkgLSBzZWUgYmVsb3cpXG4gICAqIC0gZnJvbSB0aGUgU1RSSVBFJyBkYXNoYm9hcmRcbiAgICovXG4gIGlmIChldmVudC50eXBlID09PSAnY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQnKSB7XG4gICAgd2luc3Rvbi5pbmZvKCcgISEhISEhISEgSEkgISEhISEhISEhISEgY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQnKTtcbiAgICB3aW5zdG9uLmluZm8oJ2N1c3RvbWVyLnN1YnNjcmlwdGlvbi5kZWxldGVkIGV2ZW50ICcsIGV2ZW50KTtcbiAgICB2YXIgc3Vic2NyaXB0aW9uSWQgPSBldmVudC5kYXRhLm9iamVjdC5pZFxuICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBzdWJzY3JpcHRpb24gSUQgJywgc3Vic2NyaXB0aW9uSWQpO1xuXG4gICAgdmFyIHN1YnNjcmlwdGlvbkVuZCA9IG1vbWVudC51bml4KGV2ZW50LmRhdGEub2JqZWN0LmNhbmNlbGVkX2F0KS5mb3JtYXQoJ1lZWVktTU0tRERUSEg6bW06c3MuU1NTJylcbiAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogc3Vic2NyaXB0aW9uRW5kICcsIHN1YnNjcmlwdGlvbkVuZCk7XG5cbiAgICBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudChzdWJzY3JpcHRpb25JZCkudGhlbihmdW5jdGlvbiAoc3Vic2NyaXB0aW9uUGF5bWVudCkge1xuICAgICAgLy8gU3Vic2NyaXB0aW9uUGF5bWVudC5maW5kKHsgc3Vic2NyaXB0aW9uX2lkOiBzdWJzY3JpcHRpb25JZCwgb2JqZWN0X3R5cGU6IFwic3Vic2NyaXB0aW9uXCIgfSwgZnVuY3Rpb24gKGVyciwgc3Vic2NyaXB0aW9uUGF5bWVudCkge1xuXG4gICAgICAvLyBpZiAoZXJyKSB7XG4gICAgICAvLyAgIHdpbnN0b24uaW5mbygnRXJyb3IgZ2V0dGluZyB0aGUgc3Vic2NyaXB0aW9uUGF5bWVudCAnLCBlcnIpO1xuICAgICAgLy8gICByZXR1cm4gZXJyO1xuICAgICAgLy8gfVxuICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIMK7wrvCuyDCu8K7wrsgY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQgc3Vic2NyaXB0aW9uUGF5bWVudCAnLCBzdWJzY3JpcHRpb25QYXltZW50KTtcbiAgICAgIGlmIChzdWJzY3JpcHRpb25QYXltZW50KSB7IFxuICAgICAgICB2YXIgcHJvamVjdElkID0gc3Vic2NyaXB0aW9uUGF5bWVudC5wcm9qZWN0X2lkOyBcbiAgICAgICAgd2luc3Rvbi5pbmZvKCdjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCBzdWJzY3JpcHRpb25QYXltZW50IHByb2plY3QgaWQ6ICcsIHByb2plY3RJZClcbiAgICAgICAgXG4gICAgICAgIHZhciB1c2VySWQgPSBzdWJzY3JpcHRpb25QYXltZW50LnVzZXJfaWQ7XG4gICAgICAgIHdpbnN0b24uaW5mbygnY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQgc3Vic2NyaXB0aW9uUGF5bWVudCB1c2VyIGlkOiAnLCB1c2VySWQpXG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICohICoqKiBCT0RZICoqKlxuICAgICAgICovXG4gICAgICB2YXIgYm9keSA9IHtcbiAgICAgICAgcHJvZmlsZToge1xuICAgICAgICAgIHN1YnNjcmlwdGlvbklkOiBzdWJzY3JpcHRpb25JZCxcbiAgICAgICAgICBuYW1lOiAnU2FuZGJveCcsXG4gICAgICAgICAgdHlwZTogJ2ZyZWUnLFxuICAgICAgICAgIGFnZW50czogMSxcbiAgICAgICAgICBsYXN0X3N0cmlwZV9ldmVudDogZXZlbnQudHlwZSxcbiAgICAgICAgICBzdWJFbmQ6IHN1YnNjcmlwdGlvbkVuZFxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHdpbnN0b24uaW5mbyhcImN1c3RvbWVyLnN1YnNjcmlwdGlvbi5kZWxldGVkIHByb2ZpbGUgdG8gdXBkYXRlIChldmVudC5kYXRhLm9iamVjdC5jYW5jZWxlZF9hdCkgXCIsIGV2ZW50LmRhdGEub2JqZWN0LmNhbmNlbGVkX2F0KVxuICAgICAgd2luc3Rvbi5pbmZvKFwiY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQgcHJvZmlsZSB0byB1cGRhdGUgXCIsIGJvZHkucHJvZmlsZSlcbiAgICAgIFxuICAgICAgdXBkYXRlUHJvamVjdFByb2ZpbGUocHJvamVjdElkLCBib2R5LCAnc3Vic2NyaXB0aW9uLmRlbGV0ZWQnKTtcbiAgICAgIHNhdmVPbkRCKHN1YnNjcmlwdGlvbklkLCBwcm9qZWN0SWQsIGV2ZW50LmRhdGEub2JqZWN0LCB1c2VySWQsIGV2ZW50LnR5cGUsIHBsYW5fbmFtZSwgMSk7XG5cbiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICB3aW5zdG9uLmVycm9yKCcqKiogKioqIGN1c3RvbWVyLnN1YnNjcmlwdGlvbi5kZWxldGVkICcsIGVycik7XG4gICAgfSk7XG5cbiAgfVxuICAvLyBSZXR1cm4gYSByZXNwb25zZSB0byBhY2tub3dsZWRnZSByZWNlaXB0IG9mIHRoZSBldmVudFxuICByZXNwb25zZS5qc29uKHsgcmVjZWl2ZWQ6IHRydWUgfSk7XG59KTtcblxuXG5mdW5jdGlvbiBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudChzdWJzY3JpcHRpb25pZCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgIFN1YnNjcmlwdGlvblBheW1lbnQuZmluZE9uZSh7IHN1YnNjcmlwdGlvbl9pZDogc3Vic2NyaXB0aW9uaWQsIHN0cmlwZV9ldmVudDogXCJjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZFwiIH0sIGZ1bmN0aW9uIChlcnIsIHN1YnNjcmlwdGlvblBheW1lbnQpIHtcbiAgICAgIGlmIChlcnIpIHJlamVjdChlcnIpO1xuXG4gICAgICB2YXIgc3Vic2NyaXB0aW9uX3BheW1lbnQgPSBzdWJzY3JpcHRpb25QYXltZW50O1xuICAgICAgcmVzb2x2ZShzdWJzY3JpcHRpb25fcGF5bWVudCk7XG4gICAgfSk7XG4gIH0pXG59O1xuXG5mdW5jdGlvbiBnZXRTdWJzY3JpdGlvbkJ5SWQoc3Vic2NyaXB0aW9uaWQpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICBjb25zdCBfc3RyaXBlID0gcmVxdWlyZShcInN0cmlwZVwiKShhcGlTZWNyZXRLZXkpO1xuICAgIF9zdHJpcGUuc3Vic2NyaXB0aW9ucy5yZXRyaWV2ZShzdWJzY3JpcHRpb25pZCwgZnVuY3Rpb24gKGVyciwgc3Vic2NyaXB0aW9uKSB7XG4gICAgICBpZiAoZXJyKSByZWplY3QoZXJyKTtcblxuICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHN1YnNjcmlwdGlvbjtcbiAgICAgIHJlc29sdmUoc3Vic2NyaXB0aW9uKTtcbiAgICB9KTtcbiAgfSlcbn07XG5cbi8vIFNFRSBVcGRhdGluZyBuZXN0ZWQgb2JqZWN0IGluIG1vbmdvb3NlIFxuLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjM4MzI5MjEvdXBkYXRpbmctbmVzdGVkLW9iamVjdC1pbi1tb25nb29zZVxuZnVuY3Rpb24gdXBkYXRlUHJvamVjdFByb2ZpbGUocHJvamVjdF9pZCwgYm9keSwgY2FsbGVkQnkpIHtcbiAgUHJvamVjdC5maW5kQnlJZEFuZFVwZGF0ZShwcm9qZWN0X2lkLCBib2R5LCB7IG5ldzogdHJ1ZSwgdXBzZXJ0OiB0cnVlIH0sIGZ1bmN0aW9uIChlcnIsIHVwZGF0ZWRQcm9qZWN0KSB7XG4gICAgaWYgKGVycikge1xuICAgICAgd2luc3Rvbi5lcnJvcigndXBkYXRlUHJvamVjdFByb2ZpbGUgRXJyb3IgJywgZXJyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2luc3Rvbi5kZWJ1Zyh1cGRhdGVkUHJvamVjdClcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBzYXZlT25EQihzdWJzY3JpcHRpb25pZCwgcHJvamVjdGlkLCBvYmosIHVzZXJpZCwgc3RyaXBlX2V2ZW50LCBwbGFuX25hbWUsIHNlYXRzX251bSkge1xuICB3aW5zdG9uLmluZm8oJ3NhdmVPbkRCIHBsYW5fbmFtZScsIHBsYW5fbmFtZSlcbiAgd2luc3Rvbi5pbmZvKCdzYXZlT25EQiBzZWF0c19udW0nLCBzZWF0c19udW0pXG5cbiAgdmFyIG5ld1BheW1lbnRTdWJzY3JpcHRpb24gPSBuZXcgU3Vic2NyaXB0aW9uUGF5bWVudCh7XG4gICAgX2lkOiBuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQoKSxcbiAgICBzdWJzY3JpcHRpb25faWQ6IHN1YnNjcmlwdGlvbmlkLFxuICAgIHByb2plY3RfaWQ6IHByb2plY3RpZCxcbiAgICB1c2VyX2lkOiB1c2VyaWQsXG4gICAgc3RyaXBlX2V2ZW50OiBzdHJpcGVfZXZlbnQsXG4gICAgcGxhbl9uYW1lOiBwbGFuX25hbWUsXG4gICAgYWdlbnRzOiBzZWF0c19udW0sXG4gICAgb2JqZWN0OiBvYmpcbiAgfSk7XG5cbiAgbmV3UGF5bWVudFN1YnNjcmlwdGlvbi5zYXZlKGZ1bmN0aW9uIChlcnIsIHNhdmVkU3Vic2NyaXB0aW9uUGF5bWVudCkge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIHdpbnN0b24uZXJyb3IoJy0tLSA+IEVSUk9SICcsIGVycilcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCh7IHN1Y2Nlc3M6IGZhbHNlLCBtc2c6ICdFcnJvciBzYXZpbmcgb2JqZWN0LicgfSk7XG4gICAgfVxuICAgIHdpbnN0b24uaW5mbygnc2F2ZWRTdWJzY3JpcHRpb25QYXltZW50ICcsIHNhdmVkU3Vic2NyaXB0aW9uUGF5bWVudCk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBzYXZlRmlyc3RJbnZvaWNlUGF5bWVudFN1Y2NlZWRlZChzdWJzY3JpcHRpb25pZCwgb2JqLCBzdHJpcGVfZXZlbnQpIHtcbiAgY29uc29sZS5sb2coJ3NhdmVGaXJzdEludm9pY2VQYXltZW50U3VjY2VlZGVkIHN1YnNjcmlwdGlvbmlkJywgc3Vic2NyaXB0aW9uaWQpXG4gIGNvbnNvbGUubG9nKCdzYXZlRmlyc3RJbnZvaWNlUGF5bWVudFN1Y2NlZWRlZCBzdHJpcGVfZXZlbnQnLCBzdHJpcGVfZXZlbnQpXG5cbiAgdmFyIG5ld1BheW1lbnRTdWJzY3JpcHRpb24gPSBuZXcgU3Vic2NyaXB0aW9uUGF5bWVudCh7XG4gICAgX2lkOiBuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQoKSxcbiAgICBzdWJzY3JpcHRpb25faWQ6IHN1YnNjcmlwdGlvbmlkLFxuICAgIHN0cmlwZV9ldmVudDogc3RyaXBlX2V2ZW50LFxuICAgIG9iamVjdDogb2JqXG4gIH0pO1xuXG4gIG5ld1BheW1lbnRTdWJzY3JpcHRpb24uc2F2ZShmdW5jdGlvbiAoZXJyLCBzYXZlZFN1YnNjcmlwdGlvblBheW1lbnQpIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICB3aW5zdG9uLmVycm9yKCctLS0gPiBFUlJPUiAnLCBlcnIpXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBzdWNjZXNzOiBmYWxzZSwgbXNnOiAnRXJyb3Igc2F2aW5nIG9iamVjdC4nIH0pO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZygnc2F2ZWRTdWJzY3JpcHRpb25QYXltZW50ID4+ICcsIHNhdmVkU3Vic2NyaXB0aW9uUGF5bWVudCk7XG4gIH0pO1xufVxuXG5yb3V0ZXIucHV0KCcvY2FuY2Vsc3Vic2NyaXB0aW9uJywgW3Bhc3Nwb3J0LmF1dGhlbnRpY2F0ZShbJ2Jhc2ljJywgJ2p3dCddLCB7IHNlc3Npb246IGZhbHNlIH0pLCB2YWxpZHRva2VuXSwgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gIHZhciBwcm9qZWN0aWQgPSByZXEuYm9keS5wcm9qZWN0aWRcbiAgdmFyIHVzZXJpZCA9IHJlcS5ib2R5LnVzZXJpZFxuICB3aW5zdG9uLmluZm8oJ8K7wrvCuyDCu8K7wrsgY2FuY2Vsc3Vic2NyaXB0aW9uIHByb2plY3RpZCcsIHByb2plY3RpZCk7XG4gIHdpbnN0b24uaW5mbygnwrvCu8K7IMK7wrvCuyBjYW5jZWxzdWJzY3JpcHRpb24gdXNlcmlkJywgdXNlcmlkKTtcblxuICBQcm9qZWN0LmZpbmRPbmUoeyBfaWQ6IHByb2plY3RpZCB9LCBmdW5jdGlvbiAoZXJyLCBwcm9qZWN0KSB7XG4gICAgaWYgKGVycikge1xuICAgICAgd2luc3Rvbi5lcnJvcignLS0gPiBjYW5jZWxzdWJzY3JpcHRpb24gRXJyb3IgZ2V0dGluZyBwcm9qZWN0ICcsIGVycilcbiAgICAgIHJldHVybiAoZXJyKTtcbiAgICB9XG4gICAgaWYgKHByb2plY3QpIHtcbiAgICAgIHdpbnN0b24uaW5mbygnLS0gPiBjYW5jZWxzdWJzY3JpcHRpb24gIHByb2plY3QgJywgcHJvamVjdCk7XG5cbiAgICAgIHZhciBzdWJzY3JpcHRpb25pZCA9IHByb2plY3QucHJvZmlsZS5zdWJzY3JpcHRpb25JZDtcblxuICAgICAgY29uc3Qgc3RyaXBlID0gcmVxdWlyZShcInN0cmlwZVwiKShhcGlTZWNyZXRLZXkpO1xuXG4gICAgICBzdHJpcGUuc3Vic2NyaXB0aW9ucy5kZWwoc3Vic2NyaXB0aW9uaWQsIGZ1bmN0aW9uIChlcnIsIGNvbmZpcm1hdGlvbikge1xuICAgICAgICAvLyBhc3luY2hyb25vdXNseSBjYWxsZWRcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHdpbnN0b24uZXJyb3IoJy0tID4gY2FuY2Vsc3Vic2NyaXB0aW9uICBlcnIgJywgZXJyKTtcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBzdWNjZXNzOiBmYWxzZSwgbXNnOiBlcnIgfSlcbiAgICAgICAgfVxuICAgICAgICB3aW5zdG9uLmluZm8oJy0tID4gY2FuY2Vsc3Vic2NyaXB0aW9uIGNvbmZpcm1hdGlvbiAnLCBjb25maXJtYXRpb24pXG4gICAgICAgIHJlcy5qc29uKGNvbmZpcm1hdGlvbik7XG4gICAgICB9KTtcbiAgICB9XG4gIH0pXG59KTtcblxucm91dGVyLnB1dCgnL3VwZGF0ZXN1YnNjcmlwdGlvbicsIFtwYXNzcG9ydC5hdXRoZW50aWNhdGUoWydiYXNpYycsICdqd3QnXSwgeyBzZXNzaW9uOiBmYWxzZSB9KSwgdmFsaWR0b2tlbl0sIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuXG4gIHZhciBwcm9qZWN0aWQgPSByZXEuYm9keS5wcm9qZWN0aWRcbiAgdmFyIHVzZXJpZCA9IHJlcS5ib2R5LnVzZXJpZFxuICB2YXIgcHJpY2UgPSByZXEuYm9keS5wcmljZVxuICB3aW5zdG9uLmluZm8oJ8K7wrvCuyDCu8K7wrsgdXBkYXRlc3Vic2NyaXB0aW9uIHByb2plY3RpZCcsIHByb2plY3RpZCk7XG4gIHdpbnN0b24uaW5mbygnwrvCu8K7IMK7wrvCuyB1cGRhdGVzdWJzY3JpcHRpb24gdXNlcmlkJywgdXNlcmlkKTtcbiAgd2luc3Rvbi5pbmZvKCfCu8K7wrsgwrvCu8K7IHVwZGF0ZXN1YnNjcmlwdGlvbiBwcmljZScsIHByaWNlKTtcbiAgY29uc3Qgc3RyaXBlID0gcmVxdWlyZShcInN0cmlwZVwiKShhcGlTZWNyZXRLZXkpO1xuXG4gIFByb2plY3QuZmluZE9uZSh7IF9pZDogcHJvamVjdGlkIH0sIGZ1bmN0aW9uIChlcnIsIHByb2plY3QpIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICB3aW5zdG9uLmVycm9yKCctLSA+IHVwZGF0ZXN1YnNjcmlwdGlvbiBFcnJvciBnZXR0aW5nIHByb2plY3QgJywgZXJyKVxuICAgICAgcmV0dXJuIChlcnIpO1xuICAgIH1cbiAgICBpZiAocHJvamVjdCkge1xuICAgICAgd2luc3Rvbi5pbmZvKCctLSA+IHVwZGF0ZXN1YnNjcmlwdGlvbiAgcHJvamVjdCAnLCBwcm9qZWN0KTtcblxuICAgICAgdmFyIHN1YnNjcmlwdGlvbmlkID0gcHJvamVjdC5wcm9maWxlLnN1YnNjcmlwdGlvbklkO1xuXG4gICAgICAvLyBzdWJzY3JpcHRpb25pZFxuICAgICAgc3RyaXBlLnN1YnNjcmlwdGlvbnMudXBkYXRlKFxuICAgICAgICBzdWJzY3JpcHRpb25pZCxcbiAgICAgICAgLy8geyB0cmlhbF9lbmQ6IDE1NjgyMTA2NTUgfSxcbiAgICAgICAgLy8gZnVuY3Rpb24gKGVyciwgc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIC8vICAgLy8gYXN5bmNocm9ub3VzbHkgY2FsbGVkXG4gICAgICAgIC8vICAgaWYgKGVycikge1xuICAgICAgICAvLyAgICAgd2luc3Rvbi5lcnJvcigndXBkYXRlc3Vic2NyaXB0aW9uIHN1YnNjcmlwdGlvbiBlcnIgJywgZXJyKVxuICAgICAgICAvLyAgICAgcmV0dXJuXG4gICAgICAgIC8vICAgfVxuICAgICAgICAvLyAgIHdpbnN0b24uaW5mbygndXBkYXRlc3Vic2NyaXB0aW9uIHN1YnNjcmlwdGlvbiAnLCBzdWJzY3JpcHRpb24pXG4gICAgICAgIC8vIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gc3RyaXBlLnN1YnNjcmlwdGlvbnMucmV0cmlldmUoc3Vic2NyaXB0aW9uaWQsIGZ1bmN0aW9uIChlcnIsIHN1YnNjcmlwdGlvbikge1xuICAgIC8vICAgLy8gYXN5bmNocm9ub3VzbHkgY2FsbGVkXG4gICAgLy8gICBpZiAoZXJyKSB7XG4gICAgLy8gICAgIHdpbnN0b24uaW5mbygncmV0cmlldmUgdXBkYXRlZCBzdWJzY3JpcHRpb24gZXJyICcsIGVycilcbiAgICAvLyAgIH0gZWxzZSB7XG4gICAgLy8gICAgIHdpbnN0b24uaW5mbygnwrvCu8K7wrvCu8K7wrvCu8K7IGdyZXRyaWV2ZSB1cGRhdGVkIHN1YnNjcmlwdGlvbjogJywgc3Vic2NyaXB0aW9uKTtcblxuICAgIC8vICAgfVxuICAgIC8vIH0pXG4gIH0pXG5cbn0pXG5cbnJvdXRlci5nZXQoJy86c3Vic2NyaXB0aW9uaWQnLCBbcGFzc3BvcnQuYXV0aGVudGljYXRlKFsnYmFzaWMnLCAnand0J10sIHsgc2Vzc2lvbjogZmFsc2UgfSksIHZhbGlkdG9rZW5dLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcblxuICBTdWJzY3JpcHRpb25QYXltZW50LmZpbmQoeyBzdWJzY3JpcHRpb25faWQ6IHJlcS5wYXJhbXMuc3Vic2NyaXB0aW9uaWQgfSkuc29ydCh7ICdvYmplY3QuY3JlYXRlZCc6IFwiYXNjXCIgfSkuZXhlYyhmdW5jdGlvbiAoZXJyLCBzdWJzY3JpcHRpb25QYXltZW50cykge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIHdpbnN0b24uZXJyb3IoJy0tID4gR0VUIFNVQlNDUklQVElPTiBQQVlNRU5UUyBFUlJPUnQgJywgcHJvamVjdCk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBzdWNjZXNzOiBmYWxzZSwgbXNnOiBlcnIgfSlcbiAgICB9XG4gICAgcmVzLmpzb24oc3Vic2NyaXB0aW9uUGF5bWVudHMpO1xuICB9KTtcblxufSk7XG5cbi8vICBSRVRSSUVWRSBUSEUgQ1VSUkVOVCBTVUJTQ1JJUFRJT04gRlJPTSBTVFJJUEVcbnJvdXRlci5nZXQoJy9zdHJpcGVzdWJzLzpzdWJzY3JpcHRpb25pZCcsIFtwYXNzcG9ydC5hdXRoZW50aWNhdGUoWydiYXNpYycsICdqd3QnXSwgeyBzZXNzaW9uOiBmYWxzZSB9KSwgdmFsaWR0b2tlbl0sIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuXG4gIHdpbnN0b24uaW5mbygnLS0gPiBzdWJzY3JpcHRpb24gZ2V0IGJ5IGlkIGZyZXEucGFyYW1zLnN1YnNjcmlwdGlvbmlkICcsIHJlcS5wYXJhbXMuc3Vic2NyaXB0aW9uaWQpO1xuICB2YXIgc3RyaXBlID0gcmVxdWlyZSgnc3RyaXBlJykoYXBpU2VjcmV0S2V5KTtcblxuICBzdHJpcGUuc3Vic2NyaXB0aW9ucy5yZXRyaWV2ZShcbiAgICByZXEucGFyYW1zLnN1YnNjcmlwdGlvbmlkLFxuICAgIGZ1bmN0aW9uIChlcnIsIHN1YnNjcmlwdGlvbikge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICB3aW5zdG9uLmVycm9yKCctLSA+IHN1YnNjcmlwdGlvbiBnZXQgYnkgaWQgZnJvbSBzdHJpcGUgIGVyciAnLCBlcnIpO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBzdWNjZXNzOiBmYWxzZSwgbXNnOiBlcnIgfSlcbiAgICAgIH1cbiAgICAgIHdpbnN0b24uaW5mbygnLS0gPiBzdWJzY3JpcHRpb24gZ2V0IGJ5IGlkIGZyb20gc3RyaXBlICcsIHN1YnNjcmlwdGlvbilcbiAgICAgIHJlcy5qc29uKHN1YnNjcmlwdGlvbik7XG4gICAgfVxuICApO1xufSk7XG5cbi8vICBSRVRSSUVWRSBUSEUgQ0hFQ0tPVVQgU0VTU0lPTlxucm91dGVyLmdldCgnL2NoZWNrb3V0U2Vzc2lvbi86c2Vzc2lvbmlkJywgW3Bhc3Nwb3J0LmF1dGhlbnRpY2F0ZShbJ2Jhc2ljJywgJ2p3dCddLCB7IHNlc3Npb246IGZhbHNlIH0pLCB2YWxpZHRva2VuXSwgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG5cbiAgd2luc3Rvbi5pbmZvKCctLSA+IGNoZWNrb3V0U2Vzc2lvbiBwYXJhbXMuc2Vzc2lvbmlkICcsIHJlcS5wYXJhbXMuc2Vzc2lvbmlkKTtcbiAgdmFyIHN0cmlwZSA9IHJlcXVpcmUoJ3N0cmlwZScpKGFwaVNlY3JldEtleSk7XG5cbiAgc3RyaXBlLmNoZWNrb3V0LnNlc3Npb25zLnJldHJpZXZlKFxuICAgIHJlcS5wYXJhbXMuc2Vzc2lvbmlkLFxuICAgIGZ1bmN0aW9uIChlcnIsIHNlc3Npb24pIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgd2luc3Rvbi5pbmZvKCctLSA+IGNoZWNrb3V0U2Vzc2lvbiBnZXQgYnkgaWQgZnJvbSBzdHJpcGUgIGVyciAnLCBlcnIpO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBzdWNjZXNzOiBmYWxzZSwgbXNnOiBlcnIgfSlcbiAgICAgIH1cbiAgICAgIHdpbnN0b24uaW5mbygnLS0gPiBjaGVja291dFNlc3Npb24gZ2V0IGJ5IGlkIGZyb20gc3RyaXBlICcsIHNlc3Npb24pXG4gICAgICByZXMuanNvbihzZXNzaW9uKTtcbiAgICB9XG4gICk7XG59KTtcblxuLy9uZXcgY29kZVxucm91dGVyLmdldCgnL2N1c3RvbWVyLzpwcm9qZWN0aWQnLCBbcGFzc3BvcnQuYXV0aGVudGljYXRlKFsnYmFzaWMnLCAnand0J10sIHsgc2Vzc2lvbjogZmFsc2UgfSksIHZhbGlkdG9rZW5dLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgd2luc3Rvbi5kZWJ1ZygnwrvCu8K7IMK7wrvCuyBnZXQgY3VzdG9tZXIgZnJvbSBkYiAnLCByZXEucGFyYW1zKVxuICB2YXIgcHJvamVjdGlkID0gcmVxLnBhcmFtcy5wcm9qZWN0aWRcblxuICB3aW5zdG9uLmRlYnVnKCfCu8K7wrsgwrvCu8K7IGdldCBjdXN0b21lciBmcm9tIGRiIC0gcHJvamVjdGlkJywgcHJvamVjdGlkKTtcblxuICBTdWJzY3JpcHRpb25QYXltZW50LmZpbmQoeyBwcm9qZWN0X2lkOiBwcm9qZWN0aWQsIHN0cmlwZV9ldmVudDogXCJjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZFwiIH0sIGFzeW5jIGZ1bmN0aW9uIChlcnIsIHN1YnNjcmlwdGlvbikge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIHdpbnN0b24uZGVidWcoJy0tID4gZ2V0IGN1c3RvbWVyIGZyb20gZGIgLSBFcnJvciAnLCBlcnIpXG4gICAgICByZXR1cm4gKGVycik7XG4gICAgfVxuICAgIGlmIChzdWJzY3JpcHRpb24pIHtcblxuICAgICAgc3Vic2NyaXB0aW9uWzBdLm9iamVjdC5jdXN0b21lclxuICAgICAgd2luc3Rvbi5kZWJ1ZygnLS0gPiBnZXQgY3VzdG9tZXIgZnJvbSBkYiAtIHN1YnNjcmlwdGlvbiA+IGN1c3RvbWVyIGlkICcsIHN1YnNjcmlwdGlvblswXS5vYmplY3QuY3VzdG9tZXIpO1xuICAgICAgY29uc3QgY3VzdG9tZXJpZCA9IHN1YnNjcmlwdGlvblswXS5vYmplY3QuY3VzdG9tZXJcbiAgICAgIGNvbnN0IHN0cmlwZSA9IHJlcXVpcmUoXCJzdHJpcGVcIikoYXBpU2VjcmV0S2V5KTtcblxuICAgICAgY29uc3QgY3VzdG9tZXIgPSBhd2FpdCBzdHJpcGUuY3VzdG9tZXJzLnJldHJpZXZlKFxuICAgICAgICBjdXN0b21lcmlkXG4gICAgICApO1xuICAgICAgd2luc3Rvbi5kZWJ1ZygnLS0gPiBnZXQgY3VzdG9tZXIgZnJvbSBkYiA+IGN1c3RvbWVyIGZyb20gc3RyaXBlIEFQSSAnLCBjdXN0b21lcilcblxuICAgICAgY29uc3QgcGF5bWVudE1ldGhvZHMgPSBhd2FpdCBzdHJpcGUucGF5bWVudE1ldGhvZHMubGlzdCh7XG4gICAgICAgIGN1c3RvbWVyOiBjdXN0b21lcmlkLFxuICAgICAgICB0eXBlOiAnY2FyZCcsXG4gICAgICB9KTtcbiAgICAgIGN1c3RvbWVyWydwYXltZW50TWV0aG9kcyddID0gcGF5bWVudE1ldGhvZHM7XG4gICAgICB3aW5zdG9uLmRlYnVnKCctLSA+IGdldCBjdXN0b21lciBmcm9tIGRiID4gY3VzdG9tZXIgKyBwYXltZW50TWV0aG9kcyAnLCBzdWJzY3JpcHRpb24pXG4gICAgICByZXMuanNvbihjdXN0b21lcilcbiAgICB9XG4gIH0pXG59KTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gVXBkYXRlZCBjdXN0b21lclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxucm91dGVyLnBvc3QoJy9jdXN0b21lcnMvOmN1c3RvbWVyaWQnLCBbcGFzc3BvcnQuYXV0aGVudGljYXRlKFsnYmFzaWMnLCAnand0J10sIHsgc2Vzc2lvbjogZmFsc2UgfSksIHZhbGlkdG9rZW5dLCBhc3luYyBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgdmFyIGN1c3RvbWVyaWQgPSByZXEucGFyYW1zLmN1c3RvbWVyaWQ7XG4gIHdpbnN0b24uZGVidWcoJ8K7wrvCuyDCu8K7wrsgIHVwZGF0ZSBjdXN0b21lciAtIGN1c3RvbWVyaWQgZnJvbSBwYXJhbXMgJywgY3VzdG9tZXJpZCk7XG4gIHdpbnN0b24uZGVidWcoJ8K7wrvCuyDCu8K7wrsgIHVwZGF0ZSBjdXN0b21lciAtIGNjIGZyb20gYm9keSAnLCByZXEuYm9keSk7XG5cbiAgY29uc3Qgc3RyaXBlID0gcmVxdWlyZShcInN0cmlwZVwiKShhcGlTZWNyZXRLZXkpO1xuXG4gIGxldCBwYXltZW50TWV0aG9kO1xuICB0cnkge1xuICAgIHBheW1lbnRNZXRob2QgPSBhd2FpdCBzdHJpcGUucGF5bWVudE1ldGhvZHMuY3JlYXRlKHtcbiAgICAgIHR5cGU6ICdjYXJkJyxcbiAgICAgIGNhcmQ6IHtcbiAgICAgICAgbnVtYmVyOiByZXEuYm9keS5jcmVkaXRfY2FyZF9udW0sXG4gICAgICAgIGV4cF9tb250aDogcmVxLmJvZHkuZXhwaXJhdGlvbl9kYXRlX21vbnRoLFxuICAgICAgICBleHBfeWVhcjogcmVxLmJvZHkuZXhwaXJhdGlvbl9kYXRlX3llYXIsXG4gICAgICAgIGN2YzogcmVxLmJvZHkuY3JlZGl0X2NhcmRfY3ZjLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHdpbnN0b24uZXJyb3IoJ8K7wrvCuyDCu8K7wrsgIHBheW1lbnRNZXRob2QgY3JlYXRlICBlcnJvciAnLCBlKVxuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMikuc2VuZCh7IHN1Y2Nlc3M6IGZhbHNlLCBtc2c6IGUgfSlcblxuICB9XG4gIHdpbnN0b24uZGVidWcoJ8K7wrvCuyDCu8K7wrsgIHBheW1lbnRNZXRob2QnLCBwYXltZW50TWV0aG9kKVxuXG4gIHRyeSB7XG4gICAgY29uc3QgX3BheW1lbnRNZXRob2QgPSBhd2FpdCBzdHJpcGUucGF5bWVudE1ldGhvZHMuYXR0YWNoKFxuICAgICAgcGF5bWVudE1ldGhvZC5pZCxcbiAgICAgIHsgY3VzdG9tZXI6IGN1c3RvbWVyaWQgfVxuICAgICk7XG5cbiAgICB3aW5zdG9uLmRlYnVnKCfCu8K7wrsgwrvCu8K7ICBwYXltZW50TWV0aG9kIGF0dGFjaGVkICcsIF9wYXltZW50TWV0aG9kKVxuICB9IGNhdGNoIChlKSB7XG4gICAgd2luc3Rvbi5lcnJvcignwrvCu8K7IMK7wrvCuyAgcGF5bWVudE1ldGhvZCBhdHRhY2hlZCAgZXJyb3IgJywgZSlcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDEpLnNlbmQoeyBzdWNjZXNzOiBmYWxzZSwgbXNnOiBlIH0pXG4gIH1cblxuICBjb25zdCBfY3VzdG9tZXIgPSBhd2FpdCBzdHJpcGUuY3VzdG9tZXJzLnVwZGF0ZShcbiAgICBjdXN0b21lcmlkLFxuICAgIHtcbiAgICAgIGludm9pY2Vfc2V0dGluZ3M6IHsgZGVmYXVsdF9wYXltZW50X21ldGhvZDogcGF5bWVudE1ldGhvZC5pZCB9XG4gICAgfSk7XG4gIHJlcy5qc29uKF9jdXN0b21lcik7XG59KTtcblxuXG5yb3V0ZXIuZ2V0KCcvcGF5bWVudF9tZXRob2RzLzpjdXN0b21lcmlkJywgW3Bhc3Nwb3J0LmF1dGhlbnRpY2F0ZShbJ2Jhc2ljJywgJ2p3dCddLCB7IHNlc3Npb246IGZhbHNlIH0pLCB2YWxpZHRva2VuXSwgYXN5bmMgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gIHdpbnN0b24uaW5mbygnZ2V0IFBheW1lbnRNZXRob2RzIGxpc3QgcmVxLnBhcmFtcycsIHJlcS5wYXJhbXMpXG4gIHZhciBjdXN0b21lcl9pZCA9IHJlcS5wYXJhbXMuY3VzdG9tZXJpZDtcbiAgd2luc3Rvbi5kZWJ1ZygnZ2V0IFBheW1lbnRNZXRob2RzIGxpc3QgcmVxLnBhcmFtcyA+IGN1c3RvbWVyX2lkICcsIGN1c3RvbWVyX2lkKVxuICBjb25zdCBzdHJpcGUgPSByZXF1aXJlKFwic3RyaXBlXCIpKGFwaVNlY3JldEtleSk7XG5cbiAgY29uc3QgY3VzdG9tZXIgPSBhd2FpdCBzdHJpcGUuY3VzdG9tZXJzLnJldHJpZXZlKFxuICAgIGN1c3RvbWVyX2lkXG4gICk7XG5cbiAgY29uc3QgZGVmYXVsdF9wYXltZW50X21ldGhvZF9pZCA9IGN1c3RvbWVyLmludm9pY2Vfc2V0dGluZ3MuZGVmYXVsdF9wYXltZW50X21ldGhvZFxuICBsZXQgcGF5bWVudE1ldGhvZHM7XG4gIHRyeSB7XG4gICAgcGF5bWVudE1ldGhvZHMgPSBhd2FpdCBzdHJpcGUucGF5bWVudE1ldGhvZHMubGlzdCh7XG4gICAgICBjdXN0b21lcjogY3VzdG9tZXJfaWQsXG4gICAgICB0eXBlOiAnY2FyZCcsXG4gICAgfSk7XG4gICAgd2luc3Rvbi5kZWJ1ZygnZ2V0IFBheW1lbnRNZXRob2RzIGxpc3QgPiBwYXltZW50TWV0aG9kcyAnLCBwYXltZW50TWV0aG9kcylcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMSkuc2VuZCh7IHN1Y2Nlc3M6IGZhbHNlLCBtc2c6IGUgfSlcbiAgfVxuXG4gIHdpbnN0b24uZGVidWcoJ2dldCBQYXltZW50TWV0aG9kcyBsaXN0ID4gcGF5bWVudE1ldGhvZHMgPiBkZWZhdWx0X3BheW1lbnRfbWV0aG9kX2lkICcsIGRlZmF1bHRfcGF5bWVudF9tZXRob2RfaWQpXG4gIHBheW1lbnRNZXRob2RzLmRhdGEuZm9yRWFjaChwYXltZW50TWV0aG9kID0+IHtcbiAgICBpZiAocGF5bWVudE1ldGhvZC5pZCAhPT0gZGVmYXVsdF9wYXltZW50X21ldGhvZF9pZCkge1xuICAgICAgd2luc3Rvbi5kZWJ1ZygnZ2V0IFBheW1lbnRNZXRob2RzIGxpc3QgPiBwYXltZW50TWV0aG9kcyA+IHBheW1lbnRNZXRob2RzLmRhdGEgJywgcGF5bWVudE1ldGhvZC5pZClcbiAgICAgIGRldGFjaFBheW1lbnRGdW5jKHBheW1lbnRNZXRob2QuaWQsIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgd2luc3Rvbi5pbmZvKCdkZXRhY2hQYXltZW50RnVuYyByZXN1bHQgJywgcmVzdWx0KVxuICAgICAgfSlcbiAgICB9XG4gIH0pO1xuICByZXMuanNvbihwYXltZW50TWV0aG9kcylcbn0pXG5cbmFzeW5jIGZ1bmN0aW9uIGRldGFjaFBheW1lbnRGdW5jKHBheW1lbnRNZXRob2RpZCwgY2FsbGJhY2spIHtcbiAgd2luc3Rvbi5kZWJ1ZygnZGV0YWNoUGF5bWVudEZ1bmN0ID4gcGF5bWVudE1ldGhvZGlkICcsIHBheW1lbnRNZXRob2RpZClcbiAgY29uc3Qgc3RyaXBlID0gcmVxdWlyZShcInN0cmlwZVwiKShhcGlTZWNyZXRLZXkpO1xuICBsZXQgcGF5bWVudE1ldGhvZDtcbiAgdHJ5IHtcbiAgICBwYXltZW50TWV0aG9kID0gYXdhaXQgc3RyaXBlLnBheW1lbnRNZXRob2RzLmRldGFjaChcbiAgICAgIHBheW1lbnRNZXRob2RpZFxuICAgICk7XG4gICAgY2FsbGJhY2socGF5bWVudE1ldGhvZClcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNhbGxiYWNrKGUpXG4gIH1cbn1cblxuXG5cbi8vIGN1cmwgLVggUE9TVCAtdSBhbmRyZWEubGVvQGYyMS5pdDoxMjM0NTYgLUggJ0NvbnRlbnQtVHlwZTphcHBsaWNhdGlvbi9qc29uJyAtZCAne1widHlwZVwiOlwicGF5bWVudF9pbnRlbnQuc3VjY2VlZGVkXCJ9JyAgaHR0cDovL2xvY2FsaG9zdDozMDAwL21vZHVsZXMvcGF5bWVudHMvc3RyaXBlL3dlYmhvb2tcblxuLy8gcm91dGVyLnBvc3QoJy93ZWJob29rJywgZnVuY3Rpb24ocmVxdWVzdCwgcmVzcG9uc2UpIHtcbi8vICAgd2luc3Rvbi5pbmZvKCdzdHJpcGUgd2ViaG9vaycpO1xuXG4vLyAvLyBNYXRjaCB0aGUgcmF3IGJvZHkgdG8gY29udGVudCB0eXBlIGFwcGxpY2F0aW9uL2pzb25cbi8vIC8vIGFwcC5wb3N0KCcnLCBib2R5UGFyc2VyLnJhdyh7dHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nfSksIChyZXF1ZXN0LCByZXNwb25zZSkgPT4ge1xuLy8gICAgIGxldCBldmVudCA9IHJlcXVlc3QuYm9keTtcbi8vICAgICB3aW5zdG9uLmluZm8oJ2V2ZW50JyxldmVudCk7ICBcblxuLy8gICAgIC8vIEhhbmRsZSB0aGUgZXZlbnRcbi8vICAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcbi8vICAgICAgIGNhc2UgJ3BheW1lbnRfaW50ZW50LnN1Y2NlZWRlZCc6XG4vLyAgICAgICAgIGNvbnN0IHBheW1lbnRJbnRlbnQgPSBldmVudC5kYXRhLm9iamVjdDtcbi8vICAgICAgICAgaGFuZGxlUGF5bWVudEludGVudFN1Y2NlZWRlZChwYXltZW50SW50ZW50KTtcbi8vICAgICAgICAgYnJlYWs7XG4vLyAgICAgICBjYXNlICdwYXltZW50X21ldGhvZC5hdHRhY2hlZCc6XG4vLyAgICAgICAgIGNvbnN0IHBheW1lbnRNZXRob2QgPSBldmVudC5kYXRhLm9iamVjdDtcbi8vICAgICAgICAgaGFuZGxlUGF5bWVudE1ldGhvZEF0dGFjaGVkKHBheW1lbnRNZXRob2QpO1xuLy8gICAgICAgICBicmVhaztcbi8vICAgICAgIC8vIC4uLiBoYW5kbGUgb3RoZXIgZXZlbnQgdHlwZXNcbi8vICAgICAgIGRlZmF1bHQ6XG4vLyAgICAgICAgIC8vIFVuZXhwZWN0ZWQgZXZlbnQgdHlwZVxuLy8gICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzKDQwMCkuZW5kKCk7XG4vLyAgICAgfVxuXG4vLyAgICAgLy8gUmV0dXJuIGEgcmVzcG9uc2UgdG8gYWNrbm93bGVkZ2UgcmVjZWlwdCBvZiB0aGUgZXZlbnRcbi8vICAgICByZXNwb25zZS5qc29uKHtyZWNlaXZlZDogdHJ1ZX0pO1xuLy8gfSk7XG5cblxuXG5cbm1vZHVsZS5leHBvcnRzID0gcm91dGVyOyJdLCJmaWxlIjoicGF5bWVudHMvc3RyaXBlL2luZGV4LmpzIn0=
